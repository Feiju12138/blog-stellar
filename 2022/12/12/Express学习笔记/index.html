<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ã€ç¬”è®°ã€‘Expresså­¦ä¹ ç¬”è®° | ç»¯é çš„åšå®¢ | è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</title>

  
  <meta name="author" content="ç»¯é ">
  

  
  <meta name="description" content="æ•æ‰ä¸€åªçˆ±æŠ˜è…¾çš„ç»¯é ">
  

  
  
  <meta name="keywords" content="Nodejs">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="ã€ç¬”è®°ã€‘Expresså­¦ä¹ ç¬”è®°"/>

  <meta property="og:site_name" content="ç»¯é çš„åšå®¢"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ç»¯é çš„åšå®¢" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">ç»¯é çš„åšå®¢</a>
    </h1>
    <p class="site-description">è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">ä¸»é¡µ</a></li>
      
        <li><a href="/about/">å…³äº</a></li>
      
        <li><a href="/tags/">æ ‡ç­¾</a></li>
      
        <li><a href="/categories/">åˆ†ç±»</a></li>
      
        <li><a href="/archives/">å½’æ¡£</a></li>
      
        <li><a href="/links/">å‹é“¾</a></li>
      
        <li><a href="/reward/">èµåŠ©</a></li>
      
        <li><a href="/atom.xml">è®¢é˜…</a></li>
      
        <li><a target="_blank" rel="noopener" href="//stellar.loli.fj.cn">ä¸»é¢˜</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>ã€ç¬”è®°ã€‘Expresså­¦ä¹ ç¬”è®°</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/12/12/Expresså­¦ä¹ ç¬”è®°/" rel="bookmark">
        <time class="entry-date published" datetime="2022-12-12T08:46:21.000Z">
          2022-12-12
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Fast, unopinionated, minimalist web framework for Node.jsï¼ˆ<a href="/302.html?target=https://expressjs.com">å®˜ç½‘</a>ï¼‰</p>
<p>ä½¿ç”¨Expresså¿«é€Ÿåˆ›å»ºWebæœåŠ¡å™¨æˆ–APIæ¥å£æœåŠ¡å™¨</p>
<span id="more"></span>

<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express</span><br></pre></td></tr></table></figure>

<h2 id="åˆ›å»ºæœåŠ¡å™¨"><a href="#åˆ›å»ºæœåŠ¡å™¨" class="headerlink" title="åˆ›å»ºæœåŠ¡å™¨"></a>åˆ›å»ºæœåŠ¡å™¨</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å¼•å…¥æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="comment">// åˆ›å»ºæœåŠ¡å™¨</span></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬GETè¯·æ±‚</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç›‘å¬POSTè¯·æ±‚</span></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯åŠ¨æœåŠ¡å™¨</span></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="å¤„ç†GETè¯·æ±‚å‚æ•°"><a href="#å¤„ç†GETè¯·æ±‚å‚æ•°" class="headerlink" title="å¤„ç†GETè¯·æ±‚å‚æ•°"></a>å¤„ç†GETè¯·æ±‚å‚æ•°</h2><ul>
<li>é»˜è®¤æƒ…å†µä¸‹<code>req.query</code>æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">query</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="å¤„ç†RESTfulé£æ ¼çš„GETè¯·æ±‚å‚æ•°"><a href="#å¤„ç†RESTfulé£æ ¼çš„GETè¯·æ±‚å‚æ•°" class="headerlink" title="å¤„ç†RESTfulé£æ ¼çš„GETè¯·æ±‚å‚æ•°"></a>å¤„ç†RESTfulé£æ ¼çš„GETè¯·æ±‚å‚æ•°</h2><ul>
<li>é€šè¿‡<code>req.params</code>æ¥æ¥æ”¶RESTfulé£æ ¼çš„è¯·æ±‚å‚æ•°</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/:key1/:key2&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">params</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœå‘é€çš„è¯·æ±‚æ˜¯<code>http://127.0.0.1/value1/value2</code>ï¼Œé€šè¿‡<code>req.params</code>å¾—åˆ°çš„å“åº”å¦‚ä¸‹</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;key1&quot;: &quot;value1&quot;,</span><br><span class="line">  &quot;key2&quot;: &quot;value2&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¤„ç†POSTè¯·æ±‚ä½“æ•°æ®"><a href="#å¤„ç†POSTè¯·æ±‚ä½“æ•°æ®" class="headerlink" title="å¤„ç†POSTè¯·æ±‚ä½“æ•°æ®"></a>å¤„ç†POSTè¯·æ±‚ä½“æ•°æ®</h2><ul>
<li>å¦‚æœä¸é…ç½®è§£æè¯·æ±‚ä½“æ•°æ®çš„ä¸­é—´ä»¶ï¼Œé»˜è®¤è¿”å›undefined</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.<span class="property">body</span></span><br></pre></td></tr></table></figure>

<h2 id="è®¾ç½®å“åº”å¤´"><a href="#è®¾ç½®å“åº”å¤´" class="headerlink" title="è®¾ç½®å“åº”å¤´"></a>è®¾ç½®å“åº”å¤´</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.<span class="title function_">setHeader</span>(<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="è®¾ç½®CORSå“åº”å¤´"><a href="#è®¾ç½®CORSå“åº”å¤´" class="headerlink" title="è®¾ç½®CORSå“åº”å¤´"></a>è®¾ç½®CORSå“åº”å¤´</h3><h4 id="è®¾ç½®å…è®¸è·¨åŸŸ"><a href="#è®¾ç½®å…è®¸è·¨åŸŸ" class="headerlink" title="è®¾ç½®å…è®¸è·¨åŸŸ"></a>è®¾ç½®å…è®¸è·¨åŸŸ</h4><h5 id="å…è®¸æŒ‡å®šåŸŸçš„è·¨åŸŸè¯·æ±‚"><a href="#å…è®¸æŒ‡å®šåŸŸçš„è·¨åŸŸè¯·æ±‚" class="headerlink" title="å…è®¸æŒ‡å®šåŸŸçš„è·¨åŸŸè¯·æ±‚"></a>å…è®¸æŒ‡å®šåŸŸçš„è·¨åŸŸè¯·æ±‚</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;http://127.0.0.1:80&quot;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="å…è®¸ä»»ä½•åŸŸçš„è·¨åŸŸè¯·æ±‚"><a href="#å…è®¸ä»»ä½•åŸŸçš„è·¨åŸŸè¯·æ±‚" class="headerlink" title="å…è®¸ä»»ä½•åŸŸçš„è·¨åŸŸè¯·æ±‚"></a>å…è®¸ä»»ä½•åŸŸçš„è·¨åŸŸè¯·æ±‚</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Origin&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="è®¾ç½®å…è®¸é¢å¤–çš„è¯·æ±‚å¤´"><a href="#è®¾ç½®å…è®¸é¢å¤–çš„è¯·æ±‚å¤´" class="headerlink" title="è®¾ç½®å…è®¸é¢å¤–çš„è¯·æ±‚å¤´"></a>è®¾ç½®å…è®¸é¢å¤–çš„è¯·æ±‚å¤´</h4><ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ºäº†è®¾ç½®CORSï¼Œå®¢æˆ·ç«¯åªèƒ½å‘æœåŠ¡ç«¯å‘é€å¦‚ä¸‹9ä¸ªè¯·æ±‚å¤´ï¼š<code>Accept</code>ã€<code>Accept-Language</code>ã€<code>Content-Language</code>ã€<code>DPR</code>ã€<code>Downlink</code>ã€<code>Save-Data</code>ã€<code>Viewport-Width</code>ã€<code>Width</code>ã€<code>Content-Type</code></li>
<li>å¦‚æœéœ€è¦è®¾ç½®å…¶ä»–è¯·æ±‚å¤´ï¼Œéœ€è¦åœ¨<code>Access-Control-Allow-Headers</code>è¿›è¡Œå£°æ˜</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Headers&quot;</span>, <span class="string">&quot;X-Custom-Header&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="è®¾ç½®å…è®¸çš„è¯·æ±‚æ–¹å¼"><a href="#è®¾ç½®å…è®¸çš„è¯·æ±‚æ–¹å¼" class="headerlink" title="è®¾ç½®å…è®¸çš„è¯·æ±‚æ–¹å¼"></a>è®¾ç½®å…è®¸çš„è¯·æ±‚æ–¹å¼</h4><h5 id="å…è®¸å®¢æˆ·ç«¯å‘é€æŒ‡å®šè¯·æ±‚"><a href="#å…è®¸å®¢æˆ·ç«¯å‘é€æŒ‡å®šè¯·æ±‚" class="headerlink" title="å…è®¸å®¢æˆ·ç«¯å‘é€æŒ‡å®šè¯·æ±‚"></a>å…è®¸å®¢æˆ·ç«¯å‘é€æŒ‡å®šè¯·æ±‚</h5><ul>
<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯åªèƒ½å‘æœåŠ¡ç«¯å‘é€<code>GET</code>ã€<code>POST</code>ã€<code>HEAD</code>è¯·æ±‚</li>
<li>å¦‚æœéœ€è¦å‘é€å…¶ä»–è¯·æ±‚ï¼Œéœ€è¦ä½¿ç”¨<code>Access-Control-Allow-Methods</code>æ¥æŒ‡æ˜å…è®¸ä½¿ç”¨çš„è¯·æ±‚æ–¹å¼</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;GET, POST, PUT, DELETE&quot;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="å…è®¸å®¢æˆ·ç«¯å‘é€ä»»ä½•è¯·æ±‚"><a href="#å…è®¸å®¢æˆ·ç«¯å‘é€ä»»ä½•è¯·æ±‚" class="headerlink" title="å…è®¸å®¢æˆ·ç«¯å‘é€ä»»ä½•è¯·æ±‚"></a>å…è®¸å®¢æˆ·ç«¯å‘é€ä»»ä½•è¯·æ±‚</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.<span class="title function_">setHeader</span>(<span class="string">&quot;Access-Control-Allow-Methods&quot;</span>, <span class="string">&quot;*&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="åˆ›å»ºé™æ€èµ„æºæœåŠ¡å™¨"><a href="#åˆ›å»ºé™æ€èµ„æºæœåŠ¡å™¨" class="headerlink" title="åˆ›å»ºé™æ€èµ„æºæœåŠ¡å™¨"></a>åˆ›å»ºé™æ€èµ„æºæœåŠ¡å™¨</h2><ul>
<li>æŒ‡å®šä¸€ä¸ªç›®å½•ï¼Œå°†è¿™ä¸ªç›®å½•ä½œä¸ºé™æ€èµ„æºç›®å½•ï¼Œæ‰€æœ‰é™æ€èµ„æºçš„è¯·æ±‚å¯ä»¥ç›´æ¥è¢«è®¿é—®</li>
<li>å¦‚æœå…ˆåæŒ‡å®šäº†å¤šä¸ªç›¸åŒå±‚çº§çš„ç›¸åŒé™æ€èµ„æºï¼Œæ­¤æ—¶å…ˆæ‰˜ç®¡çš„é™æ€èµ„æºè·¯å¾„ä¼šç”Ÿæ•ˆï¼Œåæ‰˜ç®¡çš„é™æ€èµ„æºè·¯å¾„ä¸ä¼šç”Ÿæ•ˆ</li>
</ul>
<blockquote>
<p><code>./public</code>ï¼šé™æ€èµ„æºç›®å½•å</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">static</span>(<span class="string">&quot;./public&quot;</span>));</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">+ public</span><br><span class="line">  - index.html</span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤æ—¶è®¿é—®<code>http://127.0.0.1/index.html</code>æ—¶å°±ä¼šä»é™æ€èµ„æºä¸­è·å–äº†</li>
</ul>
<h3 id="æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€"><a href="#æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€" class="headerlink" title="æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€"></a>æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€</h3><ul>
<li>é€šå¸¸æƒ…å†µä¸‹è®¿é—®å‰ç¼€åä¸é™æ€èµ„æºç›®å½•åç›¸åŒ</li>
</ul>
<blockquote>
<p><code>/public</code>ï¼šè®¿é—®è·¯å¾„å‰ç¼€</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/public&quot;</span>, express.<span class="title function_">static</span>(<span class="string">&quot;./public&quot;</span>));</span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤æ—¶è®¿é—®<code>http://127.0.0.1/public/index.html</code>æ—¶å°±ä¼šä»é™æ€èµ„æºä¸­è·å–äº†</li>
</ul>
<h2 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h2><ul>
<li>å°†è¯·æ±‚ç±»å‹å’Œè¯·æ±‚è·¯å¾„æ˜ å°„åˆ°æŒ‡å®šå¤„ç†å‡½æ•°ï¼Œè¿™ç§æ˜ å°„å°±æ˜¯Expressä¸­çš„è·¯ç”±</li>
<li>è·¯ç”±æœ‰ä¼˜å…ˆçº§ï¼Œä¼šä»ä¸Šåˆ°ä¸‹ä¾æ¬¡åŒ¹é…ï¼Œå…ˆè¢«åŒ¹é…æˆåŠŸçš„è·¯ç”±å°†ä¼šå…ˆæ‰§è¡Œå¤„ç†å‡½æ•°</li>
</ul>
<h3 id="æŒ‚è½½åˆ°appå¯¹è±¡"><a href="#æŒ‚è½½åˆ°appå¯¹è±¡" class="headerlink" title="æŒ‚è½½åˆ°appå¯¹è±¡"></a>æŒ‚è½½åˆ°appå¯¹è±¡</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="æ¨¡å—åŒ–è·¯ç”±"><a href="#æ¨¡å—åŒ–è·¯ç”±" class="headerlink" title="æ¨¡å—åŒ–è·¯ç”±"></a>æ¨¡å—åŒ–è·¯ç”±</h3><ul>
<li>ä¸ºäº†æ–¹ä¾¿æ¨¡å—åŒ–ç®¡ç†ï¼Œä¸å»ºè®®ç›´æ¥å°†è·¯ç”±æŒ‚è½½åˆ°appå¯¹è±¡ï¼Œè€Œæ˜¯å°†è·¯ç”±æŠ½ç¦»ä¸ºå•ç‹¬çš„æ¨¡å—</li>
</ul>
<ol>
<li>åˆ›å»ºè·¯ç”±æ¨¡å—å¯¹åº”çš„JSæ–‡ä»¶</li>
<li>è°ƒç”¨<code>express.Router()</code>å‡½æ•°åˆ›å»ºè·¯ç”±å¯¹è±¡</li>
<li>ç”±è·¯ç”±å¯¹è±¡æŒ‚è½½å…·ä½“è·¯ç”±</li>
<li>ä½¿ç”¨<code>module.exports</code>å‘å¤–å…±äº«è·¯ç”±å¯¹è±¡</li>
<li>ä½¿ç”¨<code>app.use()</code>æ³¨å†Œè·¯ç”±æ¨¡å—</li>
</ol>
<figure class="highlight javascript"><figcaption><span>router.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><figcaption><span>index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥è·¯ç”±æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&quot;./router&quot;</span>);</span><br><span class="line"><span class="comment">// æ³¨å†Œè·¯ç”±æ¨¡å—</span></span><br><span class="line">app.<span class="title function_">use</span>(router);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<ul>
<li>ä½¿ç”¨<code>app.use()</code>æ¥æ³¨å†Œå…¨å±€ä¸­é—´ä»¶</li>
</ul>
<h4 id="æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€-1"><a href="#æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€-1" class="headerlink" title="æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€"></a>æŒ‡å®šè®¿é—®è·¯å¾„å‰ç¼€</h4><blockquote>
<p><code>/router</code>ï¼šè®¿é—®è·¯å¾„å‰ç¼€</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/router&quot;</span>, router);</span><br></pre></td></tr></table></figure>

<h2 id="ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰"><a href="#ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰" class="headerlink" title="ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰"></a>ä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰</h2><ul>
<li><p>ä¸­é—´ä»¶æŒ‡ä¸šåŠ¡æµç¨‹çš„ä¸­é—´å¤„ç†ç¯èŠ‚</p>
</li>
<li><p>Expressä¸­çš„ä¸­é—´ä»¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å¤„ç†å‡½æ•°</p>
</li>
<li><p>ä¸­é—´ä»¶å¤„ç†å‡½æ•°çš„å½¢å‚å¿…é¡»åŒ…å«<code>next</code>ï¼ŒåŒæ—¶å‡½æ•°ä½“ä¸­ç»“å°¾å¿…é¡»åŒ…å«<code>next()</code>å‡½æ•°</p>
</li>
<li><p>ä¸­é—´ä»¶å¤„ç†å‡½æ•°åœ¨åšå®Œå¤„ç†åï¼Œä¼šäº¤ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶æˆ–è·¯ç”±è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†</p>
</li>
<li><p>é™¤äº†é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ï¼Œå…¶ä»–çš„ä¸­é—´ä»¶ä¸€å®šè¦åœ¨è·¯ç”±ä¹‹å‰é…ç½®</p>
</li>
<li><p>ä¸­é—´ä»¶çš„åˆ†ç±»</p>
<ul>
<li>åº”ç”¨çº§åˆ«çš„ä¸­é—´ä»¶ï¼šç»‘å®šåˆ°<code>app</code>å®ä¾‹ä¸Šçš„ä¸­é—´ä»¶</li>
<li>è·¯ç”±çº§åˆ«çš„ä¸­é—´ä»¶ï¼šç»‘å®šåˆ°<code>express.Router()</code>å®ä¾‹ä¸Šçš„ä¸­é—´ä»¶</li>
<li>é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶ï¼šé”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶æ˜¯ä¸€ç§ç‰¹æ®Šçš„å…¨å±€ä¸­é—´ä»¶ï¼Œä¸“é—¨ç”¨æ¥æ•è·æ•´ä¸ªé¡¹ç›®ä¸­å‘ç”Ÿçš„å¼‚å¸¸é”™è¯¯ï¼Œä»è€Œé˜²æ­¢é¡¹ç›®å¼‚å¸¸å´©æºƒçš„é—®é¢˜<ul>
<li>é”™è¯¯çº§åˆ«çš„ä¸­é—´ä»¶å‡½æ•°å¿…é¡»æœ‰4ä¸ªå½¢å‚ï¼Œå½¢å‚é¡ºåºä»å‰åˆ°ååˆ†åˆ«æ˜¯<code>err</code>ã€<code>req</code>ã€<code>resp</code>ã€<code>next</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="å…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶"><a href="#å…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶" class="headerlink" title="å…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶"></a>å…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶</h3><ul>
<li>å½“å®¢æˆ·ç«¯å‘èµ·ä»»ä½•è¯·æ±‚ï¼Œåˆ°è¾¾æœåŠ¡å™¨æ—¶ï¼Œéƒ½ä¼šè§¦å‘å…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶</li>
<li>é€šè¿‡<code>app.use()</code>å¯ä»¥è®¾ç½®ä¸€ä¸ªä¸­é—´ä»¶å¤„ç†å‡½æ•°ä½œä¸ºå…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶</li>
<li>å¤šä¸ªä¸­é—´ä»¶ä¹‹é—´å…±ç”¨ä¸€ä»½<code>req</code>å’Œ<code>resp</code>å¯¹è±¡</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> func = <span class="keyword">function</span> (<span class="params">req, resp, next</span>) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å°†ä¸­é—´ä»¶å‡½æ•°è®¾ç½®ä¸ºå…¨å±€ç”Ÿæ•ˆ</span></span><br><span class="line">app.<span class="title function_">use</span>(func);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="ç®€åŒ–"><a href="#ç®€åŒ–" class="headerlink" title="ç®€åŒ–"></a>ç®€åŒ–</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½å…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">req, resp, next</span>) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="å®šä¹‰å¤šä¸ªå…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶"><a href="#å®šä¹‰å¤šä¸ªå…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰å¤šä¸ªå…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶"></a>å®šä¹‰å¤šä¸ªå…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> func = <span class="keyword">function</span> (<span class="params">req, resp, next</span>) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½å…¨å±€ç”Ÿæ•ˆä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(func);</span><br><span class="line">app.<span class="title function_">use</span>(func);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="å±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶"><a href="#å±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶" class="headerlink" title="å±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶"></a>å±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶</h3><ul>
<li>å°†ä¸­é—´ä»¶å‡½æ•°ä¼ é€’ç»™æŒ‡å®šè·¯ç”±ï¼Œä½¿ä¸­é—´ä»¶å‡½æ•°åªåœ¨æŒ‡å®šè·¯ç”±ä¸Šç”Ÿæ•ˆ</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> func = <span class="keyword">function</span> (<span class="params">req, resp, next</span>) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, func, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="å®šä¹‰å¤šä¸ªå±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶"><a href="#å®šä¹‰å¤šä¸ªå±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶" class="headerlink" title="å®šä¹‰å¤šä¸ªå±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶"></a>å®šä¹‰å¤šä¸ªå±€éƒ¨ç”Ÿæ•ˆä¸­é—´ä»¶</h4><ul>
<li>ç›´æ¥ä¼ é€’å¤šä¸ªä¸­é—´ä»¶å‡½æ•°ä¼ é€’ç»™è·¯ç”±</li>
<li>ä¹Ÿå¯ä»¥å°†å¤šä¸ªä¸­é—´ä»¶å‡½æ•°ä½œä¸ºæ•°ç»„ä¼ é€’ç»™è·¯ç”±</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> func = <span class="keyword">function</span> (<span class="params">req, resp, next</span>) &#123;</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, func, func, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, [func, func], <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="é”™è¯¯çº§åˆ«ä¸­é—´ä»¶"><a href="#é”™è¯¯çº§åˆ«ä¸­é—´ä»¶" class="headerlink" title="é”™è¯¯çº§åˆ«ä¸­é—´ä»¶"></a>é”™è¯¯çº§åˆ«ä¸­é—´ä»¶</h3><ul>
<li>é”™è¯¯çº§åˆ«ä¸­é—´ä»¶å¿…é¡»åœ¨æŒ‚è½½æ‰€æœ‰è·¯ç”±ä¹‹å</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// å®šä¹‰ä¸€ä¸ªä¸­é—´ä»¶å‡½æ•°</span></span><br><span class="line"><span class="keyword">const</span> func = <span class="keyword">function</span> (<span class="params">err, req, resp, next</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">next</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½è·¯ç”±</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/&quot;</span>, <span class="keyword">function</span>(<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// å“åº”æ•°æ®</span></span><br><span class="line">  resp.<span class="title function_">send</span>(<span class="string">&quot;ok&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŒ‚è½½é”™è¯¯çº§åˆ«ä¸­é—´ä»¶</span></span><br><span class="line">app.<span class="title function_">use</span>(func);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="Expresså†…ç½®ä¸­é—´ä»¶"><a href="#Expresså†…ç½®ä¸­é—´ä»¶" class="headerlink" title="Expresså†…ç½®ä¸­é—´ä»¶"></a>Expresså†…ç½®ä¸­é—´ä»¶</h3><h4 id="express-static"><a href="#express-static" class="headerlink" title="express.static"></a>express.static</h4><ul>
<li>å¿«é€Ÿæ‰˜ç®¡é™æ€èµ„æº</li>
<li>æ— å…¼å®¹æ€§</li>
</ul>
<h4 id="express-json"><a href="#express-json" class="headerlink" title="express.json"></a>express.json</h4><ul>
<li>è§£æJSONæ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®</li>
<li>ä»…åœ¨4.16.0åŠä»¥åçš„ç‰ˆæœ¬å¯ç”¨</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">json</span>());</span><br></pre></td></tr></table></figure>

<h4 id="express-urlencoded"><a href="#express-urlencoded" class="headerlink" title="express.urlencoded"></a>express.urlencoded</h4><ul>
<li>è§£æurl-encodedæ ¼å¼çš„è¯·æ±‚ä½“æ•°æ®</li>
<li>ä»…åœ¨4.16.0åŠä»¥åçš„ç‰ˆæœ¬å¯ç”¨</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(express.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br></pre></td></tr></table></figure>

<h3 id="ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶"><a href="#ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶" class="headerlink" title="ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶"></a>ç¬¬ä¸‰æ–¹ä¸­é—´ä»¶</h3><h4 id="body-parser"><a href="#body-parser" class="headerlink" title="body-parser"></a>body-parser</h4><ul>
<li>expresså†…ç½®ä¸­é—´ä»¶å°±æ˜¯æ ¹æ®body-parserè¿›ä¸€æ­¥å°è£…çš„</li>
</ul>
<h5 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install body-parser</span><br></pre></td></tr></table></figure>

<h5 id="å¼•å…¥"><a href="#å¼•å…¥" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> parser = <span class="built_in">require</span>(<span class="string">&quot;body-parser&quot;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="æ³¨å†Œå¹¶ä½¿ç”¨"><a href="#æ³¨å†Œå¹¶ä½¿ç”¨" class="headerlink" title="æ³¨å†Œå¹¶ä½¿ç”¨"></a>æ³¨å†Œå¹¶ä½¿ç”¨</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(parser.<span class="title function_">urlencoded</span>(&#123; <span class="attr">extended</span>: <span class="literal">false</span> &#125;));</span><br></pre></td></tr></table></figure>

<h4 id="cors"><a href="#cors" class="headerlink" title="cors"></a>cors</h4><ul>
<li>é€šè¿‡corsæ¨¡å—è§£å†³è·¨åŸŸé—®é¢˜</li>
</ul>
<h5 id="å®‰è£…-2"><a href="#å®‰è£…-2" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install cors</span><br></pre></td></tr></table></figure>

<h5 id="å¼•å…¥-1"><a href="#å¼•å…¥-1" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cors = <span class="built_in">require</span>(<span class="string">&quot;cors&quot;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="æ³¨å†Œå¹¶ä½¿ç”¨-1"><a href="#æ³¨å†Œå¹¶ä½¿ç”¨-1" class="headerlink" title="æ³¨å†Œå¹¶ä½¿ç”¨"></a>æ³¨å†Œå¹¶ä½¿ç”¨</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">cors</span>());</span><br></pre></td></tr></table></figure>

<h4 id="express-sessionè¿›è¡Œèº«ä»½è®¤è¯"><a href="#express-sessionè¿›è¡Œèº«ä»½è®¤è¯" class="headerlink" title="express-sessionè¿›è¡Œèº«ä»½è®¤è¯"></a>express-sessionè¿›è¡Œèº«ä»½è®¤è¯</h4><ul>
<li>é€šè¿‡express-sessionè¿›è¡Œèº«ä»½è®¤è¯</li>
<li>åœ¨ä¸è·¨åŸŸçš„æƒ…å†µä¸‹æ¨èä½¿ç”¨sessionè¿›è¡Œèº«ä»½è®¤è¯</li>
</ul>
<h5 id="å®‰è£…-3"><a href="#å®‰è£…-3" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express-session</span><br></pre></td></tr></table></figure>

<h5 id="å¼•å…¥-2"><a href="#å¼•å…¥-2" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> session = <span class="built_in">require</span>(<span class="string">&quot;express-session&quot;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="æ³¨å†Œ"><a href="#æ³¨å†Œ" class="headerlink" title="æ³¨å†Œ"></a>æ³¨å†Œ</h5><blockquote>
<p><code>secret</code>ï¼šéšæ„æŒ‡å®šä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºSessionçš„åŠ å¯†å¯†é’¥</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">session</span>(&#123;</span><br><span class="line">  <span class="attr">secret</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">resave</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">saveUninitialized</span>: <span class="literal">true</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<h5 id="é€šè¿‡req-sessionå¯¹è±¡ä¸­å­˜å–æ•°æ®"><a href="#é€šè¿‡req-sessionå¯¹è±¡ä¸­å­˜å–æ•°æ®" class="headerlink" title="é€šè¿‡req.sessionå¯¹è±¡ä¸­å­˜å–æ•°æ®"></a>é€šè¿‡req.sessionå¯¹è±¡ä¸­å­˜å–æ•°æ®</h5><ul>
<li>é€šå¸¸åœ¨ç™»å½•æˆåŠŸåå°†ç”¨æˆ·ç™»å½•çŠ¶æ€å’Œç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨sessionä¸­</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.<span class="property">session</span> = &#123;&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="é”€æ¯req-sessionå¯¹è±¡ä¸­å­˜å‚¨çš„æ•°æ®"><a href="#é”€æ¯req-sessionå¯¹è±¡ä¸­å­˜å‚¨çš„æ•°æ®" class="headerlink" title="é”€æ¯req.sessionå¯¹è±¡ä¸­å­˜å‚¨çš„æ•°æ®"></a>é”€æ¯req.sessionå¯¹è±¡ä¸­å­˜å‚¨çš„æ•°æ®</h5><ul>
<li>é€šå¸¸åœ¨é€€å‡ºç™»å½•åï¼Œå°†å½“å‰è¯·æ±‚çš„ç”¨æˆ·å¯¹åº”çš„sessionæ¸…é™¤</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.<span class="property">session</span>.<span class="title function_">destroy</span>();</span><br></pre></td></tr></table></figure>

<h4 id="jsonwebtokenå’Œexpress-jwt"><a href="#jsonwebtokenå’Œexpress-jwt" class="headerlink" title="jsonwebtokenå’Œexpress-jwt"></a>jsonwebtokenå’Œexpress-jwt</h4><ul>
<li>ä½¿ç”¨<code>jsonwebtoken</code>æ¨¡å—å°†JSONå­—ç¬¦ä¸²ç”ŸæˆJWTåŠ å¯†å­—ç¬¦ä¸²Token</li>
<li>ä½¿ç”¨<code>express-jwt</code>æ¨¡å—å°†JWTåŠ å¯†å­—ç¬¦ä¸²Tokenè¿˜åŸæˆJSONå¯¹è±¡</li>
</ul>
<h5 id="å®‰è£…-4"><a href="#å®‰è£…-4" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install jsonwebtoken express-jwt</span><br></pre></td></tr></table></figure>

<h5 id="å¼•å…¥-3"><a href="#å¼•å…¥-3" class="headerlink" title="å¼•å…¥"></a>å¼•å…¥</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> jwt = <span class="built_in">require</span>(<span class="string">&quot;jsonwebtoken&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> expressJWT = <span class="built_in">require</span>(<span class="string">&quot;express-jwt&quot;</span>);</span><br></pre></td></tr></table></figure>

<h5 id="å®šä¹‰ä¸€ä¸ªç”¨äºåŠ è§£å¯†çš„å¯†é’¥"><a href="#å®šä¹‰ä¸€ä¸ªç”¨äºåŠ è§£å¯†çš„å¯†é’¥" class="headerlink" title="å®šä¹‰ä¸€ä¸ªç”¨äºåŠ è§£å¯†çš„å¯†é’¥"></a>å®šä¹‰ä¸€ä¸ªç”¨äºåŠ è§£å¯†çš„å¯†é’¥</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> secretKey = <span class="string">&quot;&quot;</span>;</span><br></pre></td></tr></table></figure>

<h5 id="åŠ å¯†"><a href="#åŠ å¯†" class="headerlink" title="åŠ å¯†"></a>åŠ å¯†</h5><ul>
<li>å°†ç”¨æˆ·ç™»å½•ä¿¡æ¯åŠ å¯†æˆä¸ºtokenï¼Œå¹¶å“åº”ç»™å‰ç«¯</li>
</ul>
<blockquote>
<p><code>&lt;user&gt;</code>ï¼šéœ€è¦å­˜å‚¨çš„ç”¨æˆ·ä¿¡æ¯<br><code>secretKey</code>ï¼šæŒ‡å®šå¯†é’¥<br><code>expiresIn: &quot;&quot;</code>ï¼šæŒ‡å®šæœ‰æ•ˆæ—¶é—´</p>
<blockquote>
<p><code>s</code>ï¼šç§’<br><code>m</code>ï¼šåˆ†é’Ÿ<br><code>h</code>ï¼šå°æ—¶</p>
</blockquote>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/login&quot;</span>, <span class="keyword">function</span> (<span class="params">req, resp</span>) &#123;</span><br><span class="line">  resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="attr">token</span>: jwt.<span class="title function_">sign</span>(&lt;user&gt;, secretKey, &#123;<span class="attr">expiresIn</span>: <span class="string">&quot;30s&quot;</span>&#125;)</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h5><h6 id="æ³¨å†Œä¸­é—´ä»¶"><a href="#æ³¨å†Œä¸­é—´ä»¶" class="headerlink" title="æ³¨å†Œä¸­é—´ä»¶"></a>æ³¨å†Œä¸­é—´ä»¶</h6><ul>
<li>å°†express-jwtå¯¹è±¡ä½œä¸ºä¸­é—´ä»¶æ³¨å†Œ</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123;<span class="attr">secret</span>: secretKey&#125;));</span><br></pre></td></tr></table></figure>

<ul>
<li>é€šè¿‡<code>unless()</code>æŒ‡å®šä¸éœ€è¦é‰´æƒçš„è¯·æ±‚è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="title function_">expressJWT</span>(&#123;<span class="attr">secret</span>: secretKey&#125;).<span class="title function_">unless</span>(&#123;<span class="attr">path</span>: [<span class="regexp">/^\/dist/</span>]&#125;));</span><br></pre></td></tr></table></figure>

<h6 id="è·å–è§£å¯†åçš„å¯¹è±¡"><a href="#è·å–è§£å¯†åçš„å¯¹è±¡" class="headerlink" title="è·å–è§£å¯†åçš„å¯¹è±¡"></a>è·å–è§£å¯†åçš„å¯¹è±¡</h6><ul>
<li>ä¸­é—´ä»¶åœ¨å¾—åˆ°åŠ å¯†çš„Tokenåï¼Œä¼šè‡ªåŠ¨è§£å¯†ï¼Œå¹¶å°†è§£å¯†åçš„å¯¹è±¡æŒ‚è½½åœ¨<code>req.user</code>å¯¹è±¡ä¸Š</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&quot;/login&quot;</span>, <span class="keyword">function</span> (<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(req.<span class="property">user</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h6 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h6><ul>
<li>å¦‚æœTokenæ˜¯æ— æ•ˆæˆ–è€…è¿‡æœŸçš„ï¼Œä¼šæŠ¥é”™ï¼š<code>UnauthorizedError</code>ï¼Œé€šè¿‡å…¨å±€å¼‚å¸¸å¤„ç†å‡½æ•°å¯ä»¥æ•è·å¼‚å¸¸</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">err, req, resp, next</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (err.<span class="property">name</span> === <span class="string">&quot;UnauthorizedError&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">code</span>: <span class="string">&quot;401&quot;</span>,</span><br><span class="line">      <span class="attr">msg</span>: <span class="string">&quot;é‰´æƒå¤±è´¥&quot;</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰ä¸­é—´ä»¶"><a href="#è‡ªå®šä¹‰ä¸­é—´ä»¶" class="headerlink" title="è‡ªå®šä¹‰ä¸­é—´ä»¶"></a>è‡ªå®šä¹‰ä¸­é—´ä»¶</h3><ul>
<li>ç¤ºä¾‹ï¼šé€šè¿‡è‡ªå®šä¹‰ä¸­é—´ä»¶å®ç°express.urlencodedä¸­é—´ä»¶çš„åŠŸèƒ½<ul>
<li>å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰ä¸­é—´ä»¶</li>
<li>ç›‘å¬dataäº‹ä»¶<ul>
<li>åœ¨ä¸­é—´ä»¶ä¸­ï¼Œéœ€è¦åšæŒºreqå¯¹è±¡çš„dataäº‹ä»¶ï¼Œæ¥è·å–å®¢æˆ·ç«¯å‘é€åˆ°æœåŠ¡ç«¯çš„æ•°æ®</li>
<li>å¦‚æœæ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œæ— æ³•ä¸€æ¬¡æ€§å‘é€å®Œæ¯•ï¼Œåˆ™å®¢æˆ·ç«¯ä¼šæŠŠæ•°æ®åˆ‡å‰²åï¼Œåˆ†æ‰¹å‘é€åˆ°æœåŠ¡ç«¯ï¼Œæ‰€ä»¥dataäº‹ä»¶å¯èƒ½ä¼šè§¦å‘å¤šæ¬¡ï¼Œæ¯æ¬¡è§¦å‘dataäº‹ä»¶ï¸ï¼Œè·å–åˆ°çš„æ•°æ®éƒ½åªæ˜¯å®Œæ•´æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œéœ€è¦æ‰‹åŠ¨å¯¹æ¥æ”¶åˆ°çš„æ•°æ®è¿›è¡Œæ‹¼æ¥</li>
</ul>
</li>
<li>ç›‘å¬endäº‹ä»¶<ul>
<li>å½“æ•°æ®å‘é€å®Œæ¯•ï¼Œä¼šè‡ªåŠ¨è§¦å‘reqå¯¹è±¡çš„endäº‹ä»¶</li>
</ul>
</li>
<li>ä½¿ç”¨Nodejsçš„å†…ç½®æ¨¡å—querystringå°†è¯·æ±‚ä½“å­—ç¬¦ä¸²è½¬æ¢æˆJSå¯¹è±¡<ul>
<li>å¦‚æœè¯·æ±‚ä½“å­—ç¬¦ä¸²ä¸­åŒ…å«urlç¼–ç çš„ä¸­æ–‡å­—ç¬¦ï¼Œä¹Ÿä¼šè‡ªåŠ¨è§£ç </li>
</ul>
</li>
<li>å°†è§£æåçš„æ•°æ®æŒ‚è½½ä¸º<code>req.body</code></li>
<li><code>next()</code></li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">&quot;querystring&quot;</span>);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="keyword">function</span> (<span class="params">req, resp, next</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> data = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="keyword">function</span> (<span class="params">chunk</span>) &#123;</span><br><span class="line">    data += chunk;</span><br><span class="line">  &#125;);</span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    data = querystring.<span class="title function_">parse</span>(data);</span><br><span class="line">    req.<span class="property">body</span> = data;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—"><a href="#å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—" class="headerlink" title="å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—"></a>å°†è‡ªå®šä¹‰ä¸­é—´ä»¶å°è£…ä¸ºæ¨¡å—</h4><ul>
<li>å°è£…ä¸ºæ¨¡å—</li>
</ul>
<figure class="highlight javascript"><figcaption><span>æ¨¡å—å.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> querystring = <span class="built_in">require</span>(<span class="string">&quot;querystring&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> æ¨¡å—å = <span class="keyword">function</span> (<span class="params">req, resp, next</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> data = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&quot;data&quot;</span>, <span class="keyword">function</span> (<span class="params">chunk</span>) &#123;</span><br><span class="line">    data += chunk;</span><br><span class="line">  &#125;);</span><br><span class="line">  req.<span class="title function_">on</span>(<span class="string">&quot;end&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(data);</span><br><span class="line">    data = querystring.<span class="title function_">parse</span>(data);</span><br><span class="line">    req.<span class="property">body</span> = data;</span><br><span class="line">    <span class="title function_">next</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = æ¨¡å—å;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¼•å…¥æ¨¡å—</li>
</ul>
<figure class="highlight javascript"><figcaption><span>index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> æ¨¡å—å = <span class="built_in">require</span>(<span class="string">&quot;./æ¨¡å—å.js&quot;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(æ¨¡å—å);</span><br></pre></td></tr></table></figure>

<h2 id="é€šè¿‡Expressç¼–å†™åç«¯æ¥å£"><a href="#é€šè¿‡Expressç¼–å†™åç«¯æ¥å£" class="headerlink" title="é€šè¿‡Expressç¼–å†™åç«¯æ¥å£"></a>é€šè¿‡Expressç¼–å†™åç«¯æ¥å£</h2><ul>
<li>é€šè¿‡è·¯ç”±æ¨¡å—ç¼–å†™åç«¯æ¥å£</li>
</ul>
<figure class="highlight javascript"><figcaption><span>router.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> router = express.<span class="title class_">Router</span>();</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/å­è·¯å¾„&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  resp.<span class="title function_">send</span>(&#123;</span><br><span class="line">    <span class="string">&quot;code&quot;</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">&quot;msg&quot;</span>: <span class="string">&quot;ok&quot;</span>,</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: req.<span class="property">query</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = router;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><figcaption><span>index.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&quot;express&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> router = <span class="built_in">require</span>(<span class="string">&quot;./router.js&quot;</span>);</span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&quot;/çˆ¶è·¯å¾„&quot;</span>, router);</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">80</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;express server run at http://127.0.0.1&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="è¯·æ±‚çš„åˆ†ç±»"><a href="#è¯·æ±‚çš„åˆ†ç±»" class="headerlink" title="è¯·æ±‚çš„åˆ†ç±»"></a>è¯·æ±‚çš„åˆ†ç±»</h2><h3 id="ç®€å•è¯·æ±‚"><a href="#ç®€å•è¯·æ±‚" class="headerlink" title="ç®€å•è¯·æ±‚"></a>ç®€å•è¯·æ±‚</h3><ul>
<li>è¯·æ±‚æ–¹å¼ä¸º<code>GET</code>ã€<code>POST</code>ã€<code>HEAD</code>ä¹‹ä¸€çš„è¯·æ±‚</li>
<li>è¯·æ±‚å¤´å†…åªåŒ…å«<code>Accept</code>ã€<code>Accept-Language</code>ã€<code>Content-Language</code>ã€<code>DPR</code>ã€<code>Downlink</code>ã€<code>Save-Data</code>ã€<code>Viewport-Width</code>ã€<code>Width</code>ã€<code>Content-Type</code>ä¹‹ä¸€çš„ä¿¡æ¯</li>
</ul>
<h3 id="é¢„æ£€è¯·æ±‚"><a href="#é¢„æ£€è¯·æ±‚" class="headerlink" title="é¢„æ£€è¯·æ±‚"></a>é¢„æ£€è¯·æ±‚</h3><ul>
<li><p>è¯·æ±‚æ–¹å¼ä¸º<code>GET</code>ã€<code>POST</code>ã€<code>HEAD</code>ä¹‹å¤–çš„è¯·æ±‚</p>
</li>
<li><p>è¯·æ±‚å¤´å†…åŒ…å«é™¤äº†<code>Accept</code>ã€<code>Accept-Language</code>ã€<code>Content-Language</code>ã€<code>DPR</code>ã€<code>Downlink</code>ã€<code>Save-Data</code>ã€<code>Viewport-Width</code>ã€<code>Width</code>ã€<code>Content-Type</code>ä¹‹å¤–çš„ä¿¡æ¯</p>
</li>
<li><p>å®¢æˆ·ç«¯å‘æœåŠ¡æ–­å‘é€äº†<code>application/json</code>æ ¼å¼çš„æ•°æ®</p>
</li>
<li><p>é¢„æ£€è¯·æ±‚ä¸ç®€å•è¯·æ±‚çš„åŒºåˆ«ï¼šåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨æ­£å¼é€šä¿¡ä¹‹å‰ï¼Œæµè§ˆå™¨ä¼šå…ˆå‘é€<code>OPTION</code>è¯·æ±‚è¿›è¡Œé¢„æ£€ï¼Œä»¥è·çŸ¥æœåŠ¡ç«¯æ˜¯å¦å…è®¸è¯¥å®é™…è¯·æ±‚ï¼Œæ‰€ä»¥è¿™ä¸€æ¬¡<code>OPTION</code>è¯·æ±‚è¢«æˆä¸ºé¢„æ£€è¯·æ±‚ï¼ŒæœåŠ¡ç«¯æˆåŠŸå“åº”é¢„æ£€è¯·æ±‚åï¼Œå®¢æˆ·ç«¯æ‰ä¼šå‘é€çœŸæ­£çš„è¯·æ±‚ï¼Œå¹¶ä¸”æºå¸¦çœŸå®æ•°æ®</p>
</li>
</ul>
<h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><ul>
<li>æµè§ˆå™¨é€šè¿‡<code>&lt;script&gt;&lt;/script&gt;</code>æ ‡ç­¾çš„<code>src</code>å±æ€§å‘æœåŠ¡ç«¯è¯·æ±‚æ•°æ®ï¼Œå¾—åˆ°çš„æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œè¿™ç§è¯·æ±‚æ–¹å¼å°±æ˜¯JSONP</li>
<li>JSONPä¸å±äºçœŸæ­£çš„AJAXè¯·æ±‚ï¼Œå› ä¸ºæ²¡æœ‰ä½¿ç”¨<code>XMLHttpRequest</code>å¯¹è±¡</li>
<li>JSONPä»…æ”¯æŒGETè¯·æ±‚æ–¹å¼</li>
</ul>
<h3 id="ç¼–å†™JSONPæ¥å£"><a href="#ç¼–å†™JSONPæ¥å£" class="headerlink" title="ç¼–å†™JSONPæ¥å£"></a>ç¼–å†™JSONPæ¥å£</h3><ul>
<li>åº”å½“åœ¨é…ç½®corsä¸­é—´ä»¶ä¹‹å‰ç¼–å†™JSONPæ¥å£</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">get</span>(<span class="string">&quot;/jsonp&quot;</span>, <span class="keyword">function</span> (<span class="params">req, resp</span>) &#123;</span><br><span class="line">  <span class="comment">// 1. è·å–å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„å›è°ƒå‡½æ•°çš„åå­—</span></span><br><span class="line">  <span class="keyword">const</span> funcName = req.<span class="property">query</span>.<span class="property">callback</span>;</span><br><span class="line">  <span class="comment">// 2. å¾—åˆ°è¦é€šè¿‡JSONPå½¢å¼å‘é€ç»™å®¢æˆ·ç«¯çš„æ•°æ®å¯¹è±¡</span></span><br><span class="line">  <span class="keyword">let</span> data = &#123;<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>&#125;;</span><br><span class="line">  <span class="comment">// 3. æ ¹æ®å¾—åˆ°çš„æ•°æ®æ‹¼æ¥ä¸€ä¸ªå‡½æ•°è°ƒç”¨çš„å­—ç¬¦ä¸²</span></span><br><span class="line">  <span class="keyword">const</span> scriptStr = <span class="string">`<span class="subst">$&#123;funcName&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span>;</span><br><span class="line">  <span class="comment">// 4. å“åº”ç»™å‰æ®µçš„&lt;script&gt;&lt;/script&gt;æ ‡ç­¾è¿›è¡Œè§£æ</span></span><br><span class="line">  resp.<span class="title function_">send</span>(scriptStr);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="å®Œæˆ"><a href="#å®Œæˆ" class="headerlink" title="å®Œæˆ"></a>å®Œæˆ</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1a34y167AZ/">å“”å“©å“”å“©â€”â€”é»‘é©¬ç¨‹åºå‘˜</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Nodejså­¦ä¹ æŒ‡åŒ—/">Nodejså­¦ä¹ æŒ‡åŒ—</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Nodejs/">Nodejs</a>
    </span>
    

    </div>

    
  </div>
</article>

  









    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2024 ç»¯é 
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>