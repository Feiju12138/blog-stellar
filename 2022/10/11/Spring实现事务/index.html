<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ã€ç¬”è®°ã€‘Springå®ç°äº‹åŠ¡ | ç»¯é çš„åšå®¢ | è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</title>

  
  <meta name="author" content="ç»¯é ">
  

  
  <meta name="description" content="æ•æ‰ä¸€åªçˆ±æŠ˜è…¾çš„ç»¯é ">
  

  
  
  <meta name="keywords" content="Java,Spring">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="ã€ç¬”è®°ã€‘Springå®ç°äº‹åŠ¡"/>

  <meta property="og:site_name" content="ç»¯é çš„åšå®¢"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ç»¯é çš„åšå®¢" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">ç»¯é çš„åšå®¢</a>
    </h1>
    <p class="site-description">è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">ä¸»é¡µ</a></li>
      
        <li><a href="/about/">å…³äº</a></li>
      
        <li><a href="/tags/">æ ‡ç­¾</a></li>
      
        <li><a href="/categories/">åˆ†ç±»</a></li>
      
        <li><a href="/archives/">å½’æ¡£</a></li>
      
        <li><a href="/links/">å‹é“¾</a></li>
      
        <li><a href="/reward/">èµåŠ©</a></li>
      
        <li><a href="/atom.xml">è®¢é˜…</a></li>
      
        <li><a target="_blank" rel="noopener" href="//stellar.loli.fj.cn">ä¸»é¢˜</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>ã€ç¬”è®°ã€‘Springå®ç°äº‹åŠ¡</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/10/11/Springå®ç°äº‹åŠ¡/" rel="bookmark">
        <time class="entry-date published" datetime="2022-10-11T08:02:19.000Z">
          2022-10-11
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Springå®ç°äº‹åŠ¡å­¦ä¹ ç¬”è®°</p>
<span id="more"></span>

<h2 id="Springçš„äº‹åŠ¡çš„æ ¸å¿ƒæ¦‚å¿µ"><a href="#Springçš„äº‹åŠ¡çš„æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="Springçš„äº‹åŠ¡çš„æ ¸å¿ƒæ¦‚å¿µ"></a>Springçš„äº‹åŠ¡çš„æ ¸å¿ƒæ¦‚å¿µ</h2><p>å½“æ²¡æœ‰å¼€å¯Springçš„äº‹åŠ¡æ—¶ï¼Œæ¯ä¸€ä¸ªæ•°æ®å±‚æ–¹æ³•å•ç‹¬å¼€å¯ä¸€ä¸ªç‹¬ç«‹çš„äº‹åŠ¡ã€‚å½“å¼€å¯äº†Springçš„äº‹åŠ¡åï¼Œæ•´ä¸ªä¸šåŠ¡å±‚æ–¹æ³•ä½œä¸ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œè¢«è°ƒç”¨çš„æ•°æ®å±‚æ–¹æ³•å°†åŠ å…¥åˆ°ä¸šåŠ¡å±‚çš„äº‹åŠ¡ä¸­ï¼Œç»„æˆä¸€æ•´ä¸ªäº‹åŠ¡</p>
<ul>
<li>äº‹åŠ¡ç®¡ç†å‘˜ï¼šä¸šåŠ¡å±‚æ–¹æ³•ç®¡ç†æ•´ä¸ªæ–¹æ³•ä¸­å‡ºç°çš„æ‰€æœ‰äº‹åŠ¡ä½œä¸º<strong>äº‹åŠ¡ç®¡ç†å‘˜</strong></li>
<li>äº‹åŠ¡åè°ƒå‘˜ï¼šæ•°æ®å±‚æ–¹æ³•å°†è‡ªå·±ç®¡ç†çš„äº‹åŠ¡ä½œä¸º<strong>äº‹åŠ¡åè°ƒå‘˜</strong>åŠ å…¥åˆ°<strong>äº‹åŠ¡ç®¡ç†å‘˜</strong></li>
</ul>
<h2 id="å¯åŠ¨ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œäº‹åŠ¡ç®¡ç†"><a href="#å¯åŠ¨ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œäº‹åŠ¡ç®¡ç†" class="headerlink" title="å¯åŠ¨ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œäº‹åŠ¡ç®¡ç†"></a>å¯åŠ¨ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œäº‹åŠ¡ç®¡ç†</h2><ul>
<li>åœ¨Springæ ¸å¿ƒé…ç½®ç±»ä¸Šä½¿ç”¨<code>@EnableTransactionManagement</code>å¯ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œäº‹åŠ¡ç®¡ç†</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringConfig</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ·»åŠ é…ç½®ç±»"><a href="#æ·»åŠ é…ç½®ç±»" class="headerlink" title="æ·»åŠ é…ç½®ç±»"></a>æ·»åŠ é…ç½®ç±»</h2><ul>
<li>å®šä¹‰ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨å¯¹è±¡ï¼Œå¹¶å°†äº‹åŠ¡ç®¡ç†å™¨å¯¹è±¡äº¤ç»™Springå®¹å™¨ç®¡ç†</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.datasource.DataSourceTransactionManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.PlatformTransactionManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JDBCConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DataSource <span class="title function_">dataSource</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">DruidDataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DruidDataSource</span>();</span><br><span class="line">        dataSource.setDriverClassName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        dataSource.setUrl(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        dataSource.setUsername(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        dataSource.setPassword(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> dataSource;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> PlatformTransactionManager <span class="title function_">transactionManager</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="type">DataSourceTransactionManager</span> <span class="variable">transactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>();</span><br><span class="line">        transactionManager.setDataSource(dataSource);</span><br><span class="line">        <span class="keyword">return</span> transactionManager;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ·»åŠ æ³¨è§£"><a href="#æ·»åŠ æ³¨è§£" class="headerlink" title="æ·»åŠ æ³¨è§£"></a>æ·»åŠ æ³¨è§£</h2><ul>
<li>åœ¨éœ€è¦æ·»åŠ äº‹åŠ¡å¤„ç†çš„æ–¹æ³•ä¸Šæ·»åŠ <code>@Transactional</code>æ³¨è§£<ul>
<li>é€šå¸¸åŠ åœ¨ä¸šåŠ¡å±‚æ¥å£çš„æŠ½è±¡æ–¹æ³•ä¸Š</li>
</ul>
</li>
<li>ä¹Ÿå¯ä»¥å†™åœ¨ç±»æˆ–æ¥å£ä¸Šï¼Œè¢«<code>@Transactional</code>æ³¨è§£æ ‡æ³¨çš„ç±»æˆ–æ¥å£ä¸­æ‰€æœ‰æ–¹æ³•éƒ½ä¼šå¼€å¯äº‹åŠ¡</li>
</ul>
<blockquote>
<p><code>@Transactional</code>ï¼šå¼€å¯äº‹åŠ¡</p>
<blockquote>
<p><code>readOnly = true</code>ï¼šè®¾ç½®ä¸ºåªè¯»äº‹åŠ¡<br><code>timeout = -1</code>ï¼šè®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œ-1æ ‡è¯†ç”¨ä¸è¶…æ—¶<br><code>rollbackFor = &#123;NullPointException.class&#125;</code>ï¼šè®¾ç½®äº‹åŠ¡é‡åˆ°äº†æŒ‡å®šå¼‚å¸¸è¿›è¡Œå›æ»šï¼ˆç±»æ ¼å¼ï¼‰<br><code>rollbackForClassName = &quot;&quot;</code>ï¼šè®¾ç½®äº‹åŠ¡é‡åˆ°äº†æŒ‡å®šå¼‚å¸¸è¿›è¡Œå›æ»šï¼ˆå­—ç¬¦ä¸²æ ¼å¼ï¼‰<br><code>noRollbackFor = &#123;NullPointException.class&#125;</code>ï¼šè®¾ç½®äº‹åŠ¡é‡åˆ°äº†æŒ‡å®šå¼‚å¸¸ä¸è¿›è¡Œå›æ»šï¼ˆç±»æ ¼å¼ï¼‰<br><code>noRollbackForClassName = &quot;&quot;</code>ï¼šè®¾ç½®äº‹åŠ¡é‡åˆ°äº†æŒ‡å®šå¼‚å¸¸ä¸è¿›è¡Œå›æ»šï¼ˆå­—ç¬¦ä¸²æ ¼å¼ï¼‰</p>
</blockquote>
</blockquote>
<figure class="highlight java"><figcaption><span>src/main/java/com/service/impl/UserServiceImpl.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ­¤æ—¶ï¼Œå¦‚æœæ–¹æ³•æ‰§è¡Œå‡ºç°<strong>Errorå¼‚å¸¸</strong>æˆ–<strong>è¿è¡Œæ—¶å¼‚å¸¸</strong>å°†ä¼šè‡ªåŠ¨å›æ»šï¼Œå¦‚æœæ–¹æ³•æ‰§è¡Œæ²¡æœ‰å‡ºç°å¼‚å¸¸æ‰ä¼šè‡ªåŠ¨æäº¤</li>
</ul>
<h3 id="è®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º"><a href="#è®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º" class="headerlink" title="è®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º"></a>è®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</h3><ul>
<li>æŒ‡å®šå“ªäº›äº‹åŠ¡åè°ƒå‘˜åŠ å…¥åˆ°äº‹åŠ¡ç®¡ç†å‘˜</li>
</ul>
<blockquote>
<p><code>@Transactional()</code>ï¼šå¼€å¯äº‹åŠ¡</p>
<blockquote>
<p><code>propagation = REQUIRED</code>ï¼šè®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</p>
</blockquote>
</blockquote>
<table>
  <tr>
    <th>ä¼ æ’­å±æ€§</th>
    <th>äº‹åŠ¡ç®¡ç†å‘˜</th>
    <th>äº‹åŠ¡åè°ƒå‘˜</th>
  </tr>
  <tr>
    <td rowspan="2">REQUIREDï¼ˆç¼ºçœå€¼ï¼‰</td>
    <td>å¦‚æœå¼€å¯äº†äº‹åŠ¡</td>
    <td>åˆ™åŠ å…¥äº‹åŠ¡</td>
  </tr>
  <tr>
    <td>å¦‚æœæ²¡æœ‰å¼€å¯äº‹åŠ¡</td>
    <td>åˆ™æ–°å»ºäº‹åŠ¡</td>
  </tr>
  <tr>
    <td rowspan="2">REQUIRES_NEW</td>
    <td>å¦‚æœå¼€å¯äº†äº‹åŠ¡</td>
    <td>åˆ™æ–°å»ºäº‹åŠ¡</td>
  </tr>
  <tr>
    <td>å¦‚æœæ²¡æœ‰å¼€å¯äº‹åŠ¡</td>
    <td>åˆ™æ–°å»ºäº‹åŠ¡</td>
  </tr>
  <tr>
    <td rowspan="2">SUPPORTS</td>
    <td>å¦‚æœå¼€å¯äº†äº‹åŠ¡</td>
    <td>åˆ™åŠ å…¥äº‹åŠ¡</td>
  </tr>
  <tr>
    <td>å¦‚æœæ²¡æœ‰å¼€å¯äº‹åŠ¡</td>
    <td>åˆ™ä¸å¼€å¯äº‹åŠ¡</td>
  </tr>
  <tr>
    <td rowspan="2">NOT_SUPPORTED</td>
    <td>å¦‚æœå¼€å¯äº†äº‹åŠ¡</td>
    <td>åˆ™ä¸å¼€å¯äº‹åŠ¡</td>
  </tr>
  <tr>
    <td>å¦‚æœæ²¡æœ‰å¼€å¯äº‹åŠ¡</td>
    <td>åˆ™ä¸å¼€å¯äº‹åŠ¡</td>
  </tr>
  <tr>
    <td rowspan="2">MANDATORY</td>
    <td>å¦‚æœå¼€å¯äº†äº‹åŠ¡</td>
    <td>åˆ™åŠ å…¥äº‹ç‰©</td>
  </tr>
  <tr>
    <td>å¦‚æœæ²¡æœ‰å¼€å¯äº‹åŠ¡</td>
    <td>åˆ™æŠ›å¼‚å¸¸ERROR</td>
  </tr>
  <tr>
    <td rowspan="2">NEVER</td>
    <td>å¦‚æœå¼€å¯äº†äº‹åŠ¡</td>
    <td>åˆ™æŠ›å¼‚å¸¸ERROR</td>
  </tr>
  <tr>
    <td>å¦‚æœæ²¡æœ‰å¼€å¯äº‹åŠ¡</td>
    <td>åˆ™ä¸å¼€å¯äº‹åŠ¡</td>
  </tr>
  
</table>

<figure class="highlight java"><figcaption><span>src/main/java/com/service/UserService.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional(propagation = REQUIRES_NEW)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            ...</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœæƒ³è¦æ— è®ºæ˜¯å¦äº‹åŠ¡æ˜¯å¦å›æ»šéƒ½æ‰§è¡Œæ—¥å¿—è®°å½•ï¼Œå¯ä»¥å°†äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºè®¾ç½®ä¸º<code>@Transactional(propagation = REQUIRES_NEW)</code>ï¼Œå°†ä¸šåŠ¡ä»£ç å†™åœ¨<code>try &#123;&#125;</code>ä»£ç å—ï¼Œå°†æ—¥æœŸè®°å½•ä»£ç å†™åœ¨<code>finally &#123;&#125;</code>ä»£ç å—</li>
</ul>
<h2 id="å®Œæˆ"><a href="#å®Œæˆ" class="headerlink" title="å®Œæˆ"></a>å®Œæˆ</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a href="/302.html?target=https://www.bilibili.com/video/BV1Fi4y1S7ix/">å“”å“©å“”å“©â€”â€”é»‘é©¬ç¨‹åºå‘˜</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Javaåç«¯å­¦ä¹ æŒ‡åŒ—/">Javaåç«¯å­¦ä¹ æŒ‡åŒ—</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Java/">Java</a><a href="/tags/Spring/">Spring</a>
    </span>
    

    </div>

    
  </div>
</article>

  









    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2024 ç»¯é 
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>