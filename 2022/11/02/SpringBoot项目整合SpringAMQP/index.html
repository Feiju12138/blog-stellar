<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ã€ç¬”è®°ã€‘SpringBooté¡¹ç›®æ•´åˆSpringAMQP | ç»¯é çš„åšå®¢ | è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</title>

  
  <meta name="author" content="ç»¯é ">
  

  
  <meta name="description" content="æ•æ‰ä¸€åªçˆ±æŠ˜è…¾çš„ç»¯é ">
  

  
  
  <meta name="keywords" content="Java,Spring,SpringBoot,MessageQueue">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="ã€ç¬”è®°ã€‘SpringBooté¡¹ç›®æ•´åˆSpringAMQP"/>

  <meta property="og:site_name" content="ç»¯é çš„åšå®¢"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ç»¯é çš„åšå®¢" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">ç»¯é çš„åšå®¢</a>
    </h1>
    <p class="site-description">è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">ä¸»é¡µ</a></li>
      
        <li><a href="/about/">å…³äº</a></li>
      
        <li><a href="/tags/">æ ‡ç­¾</a></li>
      
        <li><a href="/categories/">åˆ†ç±»</a></li>
      
        <li><a href="/archives/">å½’æ¡£</a></li>
      
        <li><a href="/links/">å‹é“¾</a></li>
      
        <li><a href="/reward/">èµåŠ©</a></li>
      
        <li><a href="/atom.xml">è®¢é˜…</a></li>
      
        <li><a target="_blank" rel="noopener" href="//stellar.loli.fj.cn">ä¸»é¢˜</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>ã€ç¬”è®°ã€‘SpringBooté¡¹ç›®æ•´åˆSpringAMQP</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/11/02/SpringBooté¡¹ç›®æ•´åˆSpringAMQP/" rel="bookmark">
        <time class="entry-date published" datetime="2022-11-02T11:00:55.000Z">
          2022-11-02
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>SpringBooté¡¹ç›®æ•´åˆSpringAMQPå­¦ä¹ ç¬”è®°</p>
<span id="more"></span>

<h2 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-amqp<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="æ·»åŠ é…ç½®"><a href="#æ·»åŠ é…ç½®" class="headerlink" title="æ·»åŠ é…ç½®"></a>æ·»åŠ é…ç½®</h2><ul>
<li>å› ä¸ºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…éƒ½éœ€è¦è¿æ¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ‰€ä»¥éœ€è¦ç›¸åŒçš„é…ç½®</li>
</ul>
<blockquote>
<p><code>spring.rabbitmq.addresses</code>ï¼šRabbitMQçš„åœ°å€<br><code>spring.rabbitmq.port</code>ï¼šRabbitMQçš„ç«¯å£ï¼Œé»˜è®¤ä¸º5672<br><code>spring.rabbitmq.virtual-host</code>ï¼šRabbitMQçš„è™šæ‹Ÿä¸»æœº<br><code>spring.rabbitmq.username</code>ï¼šRabbitMQçš„ç”¨æˆ·å<br><code>spring.rabbitmq.password</code>ï¼šRabbitMQçš„å¯†ç </p>
</blockquote>
<figure class="highlight yaml"><figcaption><span>src/main/resource/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">addresses:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">admin</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">admin</span></span><br></pre></td></tr></table></figure>

<h2 id="ç®€å•é˜Ÿåˆ—ï¼ˆSimple-Queueï¼‰"><a href="#ç®€å•é˜Ÿåˆ—ï¼ˆSimple-Queueï¼‰" class="headerlink" title="ç®€å•é˜Ÿåˆ—ï¼ˆSimple Queueï¼‰"></a>ç®€å•é˜Ÿåˆ—ï¼ˆSimple Queueï¼‰</h2><ul>
<li>ä¸€ä¸ªç”Ÿäº§è€…å‘é˜Ÿåˆ—ä¸­å‘é€æ¶ˆæ¯</li>
<li>ä¸€ä¸ªæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ï¼Œæ¯æ¬¡è·å–æ¶ˆæ¯åï¼Œé˜…åå³ç„š</li>
</ul>
<pre><code class="highlight mermaid">graph LR
A[ç”Ÿäº§è€…] --&gt; B[æ¶ˆæ¯é˜Ÿåˆ—]
    B --&gt; C[æ¶ˆè´¹è€…]</code></pre>

<h3 id="ç”Ÿäº§è€…"><a href="#ç”Ÿäº§è€…" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h3><ul>
<li>é€šè¿‡<code>convertAndSend()</code>æ–¹æ³•å‘é€æ¶ˆæ¯</li>
</ul>
<blockquote>
<p><code>&quot;queuename&quot;</code>ï¼šæ¶ˆæ¯é˜Ÿåˆ—å<br><code>&quot;message&quot;</code>ï¼šæ¶ˆæ¯å†…å®¹</p>
</blockquote>
<figure class="highlight java"><figcaption><span>src/test/java/com/ApplicationTests.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;queuename&quot;</span>, <span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¶ˆè´¹è€…"><a href="#æ¶ˆè´¹è€…" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h3><blockquote>
<p><code>@RabbitListener(queues = &quot;&quot;)</code>ã€<code>@RabbitListener(queues = &#123;&quot;&quot;, &quot;&quot;&quot;&#125;)</code>ï¼šæŒ‡å®šé˜Ÿåˆ—åï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªé˜Ÿåˆ—å</p>
</blockquote>
<figure class="highlight java"><figcaption><span>src/main/java/com/listener/SpringRabbitMQListener.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringRabbitMQListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;queuename&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å·¥ä½œé˜Ÿåˆ—ï¼ˆWork-Queueï¼‰"><a href="#å·¥ä½œé˜Ÿåˆ—ï¼ˆWork-Queueï¼‰" class="headerlink" title="å·¥ä½œé˜Ÿåˆ—ï¼ˆWork Queueï¼‰"></a>å·¥ä½œé˜Ÿåˆ—ï¼ˆWork Queueï¼‰</h2><ul>
<li>ä¸€ä¸ªç”Ÿäº§è€…å‘é˜Ÿåˆ—ä¸­å‘é€æ¶ˆæ¯</li>
<li>å¤šä¸ªæ¶ˆè´¹è€…ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ï¼Œæ¯æ¬¡è·å–æ¶ˆæ¯åï¼Œé˜…åå³ç„š</li>
</ul>
<pre><code class="highlight mermaid">graph LR
A[ç”Ÿäº§è€…] --&gt; B[æ¶ˆæ¯é˜Ÿåˆ—]
    B --&gt; C[æ¶ˆè´¹è€…]
    B --&gt; D[æ¶ˆè´¹è€…]</code></pre>

<h3 id="ç”Ÿäº§è€…-1"><a href="#ç”Ÿäº§è€…-1" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h3><blockquote>
<p><code>&quot;queuename&quot;</code>ï¼šæ¶ˆæ¯é˜Ÿåˆ—å<br><code>&quot;message&quot;</code>ï¼šæ¶ˆæ¯å†…å®¹</p>
</blockquote>
<figure class="highlight java"><figcaption><span>src/test/java/com/ApplicationTests.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;queuename&quot;</span>, <span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¶ˆè´¹è€…-1"><a href="#æ¶ˆè´¹è€…-1" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h3><h4 id="æ·»åŠ é¢å¤–é…ç½®"><a href="#æ·»åŠ é¢å¤–é…ç½®" class="headerlink" title="æ·»åŠ é¢å¤–é…ç½®"></a>æ·»åŠ é¢å¤–é…ç½®</h4><ul>
<li>RabbitMQå†…éƒ¨æœ‰é¢„å–æœºåˆ¶ï¼Œé»˜è®¤é¢„å–æ¶ˆæ¯çš„æ•°é‡æ˜¯æ— é™</li>
<li>ä¸ºäº†é˜²æ­¢æ¶ˆè´¹è€…æå‰å°†æ¶ˆæ¯æ‹¿èµ°åå†å¤„ç†ï¼Œè€Œå¿½ç•¥äº†è‡ªèº«èƒ½åŠ›ï¼Œå¯ä»¥ä¿®æ”¹é¢„å–æ¶ˆæ¯æ•°é‡</li>
</ul>
<blockquote>
<p><code>spring.rabbitmq.listener.simple.prefetch</code>ï¼šé…ç½®é¢„å–æ¶ˆæ¯æ•°é‡ã€‚å¦‚æœè®¾ç½®ä¸º1ï¼Œæ¶ˆè´¹è€…æ¯æ¬¡åªèƒ½å…ˆæ‹¿åˆ°1æ¡æ¶ˆæ¯ï¼Œå¤„ç†å®Œåæ‰ä¼šæ‹¿ä¸‹ä¸€æ¡æ¶ˆæ¯</p>
</blockquote>
<figure class="highlight yaml"><figcaption><span>src/main/resource/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">rabbitmq:</span></span><br><span class="line">    <span class="attr">addresses:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5672</span></span><br><span class="line">    <span class="attr">virtual-host:</span> <span class="string">/</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">admin</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">admin</span></span><br><span class="line">    <span class="attr">listener:</span></span><br><span class="line">      <span class="attr">simple:</span></span><br><span class="line">        <span class="attr">prefetch:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="æ¥æ”¶æ¶ˆæ¯"><a href="#æ¥æ”¶æ¶ˆæ¯" class="headerlink" title="æ¥æ”¶æ¶ˆæ¯"></a>æ¥æ”¶æ¶ˆæ¯</h4><figure class="highlight java"><figcaption><span>src/main/java/com/listener/SpringRabbitMQListener.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringRabbitMQListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;queuename&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive1</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;queuename&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive2</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‘å¸ƒè®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å¼"></a>å‘å¸ƒè®¢é˜…æ¨¡å¼</h2><ul>
<li>ä¸€ä¸ªç”Ÿäº§è€…å‘äº¤æ¢æœºï¼ˆexchangeï¼‰ä¸­å‘é€æ¶ˆæ¯</li>
<li>äº¤æ¢æœºä¼šå°†æ¶ˆæ¯æ‹·è´å¤šä»½ï¼Œ<strong>å‘å¸ƒ</strong>ç»™å¤šä¸ª<strong>è®¢é˜…</strong>çš„é˜Ÿåˆ—</li>
<li>ä¸€ä¸ªæˆ–å¤šä¸ªæ¶ˆè´¹è€…ä»å¯¹åº”çš„é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ï¼Œæ¯æ¬¡è·å–æ¶ˆæ¯åï¼Œé˜…åå³ç„š</li>
<li>äº¤æ¢æœºåªèƒ½åšæ¶ˆæ¯çš„è½¬å‘ï¼Œå¦‚æœè½¬å‘æ²¡æœ‰æˆåŠŸï¼Œåˆ™æ¶ˆæ¯ä¼šä¸¢å¤±</li>
</ul>
<pre><code class="highlight mermaid">graph LR
A[ç”Ÿäº§è€…] --&gt; B(äº¤æ¢æœº)
    B --&gt; C[æ¶ˆæ¯é˜Ÿåˆ—]
        C --&gt; E[æ¶ˆè´¹è€…]
        C --&gt; F[æ¶ˆè´¹è€…]
    B --&gt; D[æ¶ˆæ¯é˜Ÿåˆ—]
        D --&gt; G[æ¶ˆè´¹è€…]</code></pre>

<h3 id="å¹¿æ’­æ–¹å¼ï¼ˆFanoutï¼‰"><a href="#å¹¿æ’­æ–¹å¼ï¼ˆFanoutï¼‰" class="headerlink" title="å¹¿æ’­æ–¹å¼ï¼ˆFanoutï¼‰"></a>å¹¿æ’­æ–¹å¼ï¼ˆFanoutï¼‰</h3><ul>
<li>äº¤æ¢æœºä¼šå°†æ¶ˆæ¯è·¯ç”±åˆ°æ¯ä¸€ä¸ªä¸å…¶ç»‘å®šçš„æ¶ˆæ¯é˜Ÿåˆ—</li>
</ul>
<h4 id="æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº"><a href="#æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº"></a>æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº</h4><ul>
<li>æœ¬æ¡ˆä¾‹é€šè¿‡å£°æ˜Beançš„æ–¹å¼å£°æ˜äº¤æ¢æœºã€å£°æ˜æ¶ˆæ¯é˜Ÿåˆ—ã€æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœº</li>
</ul>
<figure class="highlight java"><figcaption><span>src/main/java/com/config/FanoutConfig.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Binding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.BindingBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.FanoutExchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringBootConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FanoutConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜1ä¸ªäº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> FanoutExchange <span class="title function_">fanoutExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">FanoutExchange</span>(<span class="string">&quot;exchangename&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å£°æ˜2ä¸ªæ¶ˆæ¯é˜Ÿåˆ—</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queue1</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;queuename1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">queue2</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(<span class="string">&quot;queuename2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2ä¸ªæ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šåˆ°äº¤æ¢æœº</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">binding1</span><span class="params">(Queue queue1, FanoutExchange fanoutExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue1).to(fanoutExchange);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">binding2</span><span class="params">(Queue queue2, FanoutExchange fanoutExchange)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(queue2).to(fanoutExchange);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ç”Ÿäº§è€…-2"><a href="#ç”Ÿäº§è€…-2" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><ul>
<li>ç”Ÿäº§è€…åœ¨å‘é€æ¶ˆæ¯æ—¶éœ€è¦æŒ‡å®šäº¤æ¢æœº</li>
</ul>
<blockquote>
<p><code>&quot;exchangename&quot;</code>ï¼šäº¤æ¢æœºå<br><code>&quot;message&quot;</code>ï¼šæ¶ˆæ¯å†…å®¹</p>
</blockquote>
<figure class="highlight java"><figcaption><span>src/test/java/com/ApplicationTests.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;exchangename&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¶ˆè´¹è€…-2"><a href="#æ¶ˆè´¹è€…-2" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><figure class="highlight java"><figcaption><span>src/main/java/com/listener/SpringRabbitMQListener.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringRabbitMQListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;queuename1&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive1</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename1: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;queuename2&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive2</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename2: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è·¯ç”±æ–¹å¼ï¼ˆDirectï¼‰"><a href="#è·¯ç”±æ–¹å¼ï¼ˆDirectï¼‰" class="headerlink" title="è·¯ç”±æ–¹å¼ï¼ˆDirectï¼‰"></a>è·¯ç”±æ–¹å¼ï¼ˆDirectï¼‰</h3><ul>
<li>äº¤æ¢æœºä¼šæ ¹æ®è§„åˆ™è·¯ç”±åˆ°æŒ‡å®šçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¹¶ä¸ä¸€å®šä¼šè½¬å‘ç»™æ‰€æœ‰ç»‘å®šçš„æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>æ¯ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª<code>BindingKey</code>ä½œä¸ºè·¯ç”±çš„ä¾æ®</li>
<li>åœ¨äº¤æ¢æœºä¸Šä¼šæŒ‡å®šä¸€ä¸ª<code>RoutingKey</code>ä½œä¸ºè·¯ç”±çš„æ¡ä»¶</li>
<li>å½“<code>RoutingKey</code>ä¸<code>BindingKey</code>åŒ¹é…æˆåŠŸæ—¶ï¼Œæ‰è¿›è¡Œæ¶ˆæ¯çš„è½¬å‘</li>
</ul>
<h4 id="ç”Ÿäº§è€…-3"><a href="#ç”Ÿäº§è€…-3" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><blockquote>
<p><code>convertAndSend()</code>ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº¤æ¢æœºåï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯BindingKeyï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ¶ˆæ¯å†…å®¹</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send1</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;exchangename&quot;</span>, <span class="string">&quot;BindingKey1&quot;</span>, <span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send2</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;exchangename&quot;</span>, <span class="string">&quot;BindingKey2&quot;</span>, <span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send3</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;exchangename&quot;</span>, <span class="string">&quot;BindingKey3&quot;</span>, <span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¶ˆè´¹è€…-3"><a href="#æ¶ˆè´¹è€…-3" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><ul>
<li>æœ¬æ¡ˆä¾‹é€šè¿‡æ³¨è§£çš„æ–¹å¼å£°æ˜äº¤æ¢æœºã€å£°æ˜æ¶ˆæ¯é˜Ÿåˆ—ã€æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœº</li>
<li>åœ¨æ¶ˆè´¹è€…ä¸Šï¼Œé€šè¿‡æ³¨è§£ï¼Œå°†æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœº</li>
</ul>
<blockquote>
<p><code>value = @Queue()</code>ï¼šå£°æ˜æ¶ˆæ¯é˜Ÿåˆ—</p>
<blockquote>
<p><code>name = &quot;&quot;</code>ï¼šæŒ‡å®šæ¶ˆæ¯é˜Ÿåˆ—å</p>
</blockquote>
<p><code>exchange = @Exchange()</code>ï¼šå£°æ˜äº¤æ¢æœº</p>
<blockquote>
<p><code>name = &quot;exchangename&quot;</code>ï¼šæŒ‡å®šäº¤æ¢æœºå<br><code>type = &quot;direct&quot;</code>ã€<code>type = ExchangeTypes.DIRECT</code>ï¼šæŒ‡å®šäº¤æ¢æœºç±»å‹ï¼Œå¯ä»¥æŒ‡å®šå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå¸¸é‡ã€‚å¦‚æœä¸æŒ‡å®šï¼Œé»˜è®¤æ˜¯è·¯ç”±æ–¹å¼Direct</p>
</blockquote>
<p><code>key = &#123;&quot;BindingKey1&quot;, &quot;BindingKey3&quot;&#125;</code>ï¼šæŒ‡å®šBindingKeyï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.ExchangeTypes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.Exchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.QueueBinding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringRabbitMQListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">            value = @Queue(name = &quot;queuename1&quot;),</span></span><br><span class="line"><span class="meta">            exchange = @Exchange(name = &quot;exchangename&quot;, type = &quot;direct&quot;),</span></span><br><span class="line"><span class="meta">            key = &#123;&quot;BindingKey1&quot;, &quot;BindingKey3&quot;&#125;</span></span><br><span class="line"><span class="meta">    ))</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive1</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename1: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">            value = @Queue(name = &quot;queuename2&quot;),</span></span><br><span class="line"><span class="meta">            exchange = @Exchange(name = &quot;exchangename&quot;, type = ExchangeTypes.DIRECT),</span></span><br><span class="line"><span class="meta">            key = &#123;&quot;BindingKey2&quot;, &quot;BindingKey3&quot;&#125;</span></span><br><span class="line"><span class="meta">    ))</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive2</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename2: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è¯é¢˜æ–¹å¼ï¼ˆTopicï¼‰"><a href="#è¯é¢˜æ–¹å¼ï¼ˆTopicï¼‰" class="headerlink" title="è¯é¢˜æ–¹å¼ï¼ˆTopicï¼‰"></a>è¯é¢˜æ–¹å¼ï¼ˆTopicï¼‰</h3><ul>
<li>è¯é¢˜æ–¹å¼ä¸è·¯ç”±æ–¹å¼åŸºæœ¬ç›¸åŒï¼Œåªæ˜¯å¼•å…¥äº†é€šé…ç¬¦åŒ¹é…</li>
<li>äº¤æ¢æœºä¼šæ ¹æ®è§„åˆ™è·¯ç”±åˆ°æŒ‡å®šçš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¹¶ä¸ä¸€å®šä¼šè½¬å‘ç»™æ‰€æœ‰ç»‘å®šçš„æ¶ˆæ¯é˜Ÿåˆ—</li>
<li>æ¯ä¸€ä¸ªæ¶ˆæ¯é˜Ÿåˆ—æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ª<code>BindingKey</code>ä½œä¸ºè·¯ç”±çš„ä¾æ®ï¼Œä¸è·¯ç”±æ–¹å¼ä¸åŒçš„æ˜¯ï¼Œè¯é¢˜æ–¹å¼è¦æ±‚<code>BindingKey</code>æ˜¯ä»¥å¤šä¸ªå•è¯ç»„åˆæ„æˆï¼Œå¤šä¸ªå•è¯ä¹‹é—´ç”¨<code>.</code>åˆ†éš”</li>
<li>åœ¨äº¤æ¢æœºä¸Šä¼šæŒ‡å®šä¸€ä¸ª<code>RoutingKey</code>ä½œä¸ºè·¯ç”±çš„æ¡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦<ul>
<li><code>#</code>ï¼šè¡¨ç¤º0ä¸ªæˆ–å¤šä¸ªä»»æ„å•è¯</li>
<li><code>*</code>ï¼šè¡¨ç¤º1ä¸ªä»»æ„å•è¯</li>
</ul>
</li>
<li>å½“<code>RoutingKey</code>ä¸<code>BindingKey</code>åŒ¹é…æˆåŠŸæ—¶ï¼Œæ‰è¿›è¡Œæ¶ˆæ¯çš„è½¬å‘</li>
</ul>
<h4 id="ç”Ÿäº§è€…-4"><a href="#ç”Ÿäº§è€…-4" class="headerlink" title="ç”Ÿäº§è€…"></a>ç”Ÿäº§è€…</h4><blockquote>
<p><code>convertAndSend()</code>ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº¤æ¢æœºåï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯BindingKeyï¼ˆå¤šä¸ªå•è¯ä¹‹é—´ç”±<code>.</code>åˆ†éš”ï¼‰ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯æ¶ˆæ¯å†…å®¹</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;exchangename&quot;</span>, <span class="string">&quot;key.key&quot;</span>, <span class="string">&quot;message&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¶ˆè´¹è€…-4"><a href="#æ¶ˆè´¹è€…-4" class="headerlink" title="æ¶ˆè´¹è€…"></a>æ¶ˆè´¹è€…</h4><ul>
<li>ä¸è·¯ç”±æ–¹å¼çš„æ¶ˆè´¹è€…åŸºæœ¬ç›¸åŒï¼Œåªæ˜¯åœ¨æŒ‡å®šBindingKeyæ—¶å¯ä»¥ä½¿ç”¨é€šé…ç¬¦</li>
<li>æœ¬æ¡ˆä¾‹é€šè¿‡æ³¨è§£çš„æ–¹å¼å£°æ˜äº¤æ¢æœºã€å£°æ˜æ¶ˆæ¯é˜Ÿåˆ—ã€æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœº</li>
<li>åœ¨æ¶ˆè´¹è€…ä¸Šï¼Œé€šè¿‡æ³¨è§£ï¼Œå°†æ¶ˆæ¯é˜Ÿåˆ—ç»‘å®šäº¤æ¢æœº</li>
</ul>
<blockquote>
<p><code>value = @Queue()</code>ï¼šå£°æ˜æ¶ˆæ¯é˜Ÿåˆ—</p>
<blockquote>
<p><code>name = &quot;&quot;</code>ï¼šæŒ‡å®šæ¶ˆæ¯é˜Ÿåˆ—å</p>
</blockquote>
<p><code>exchange = @Exchange()</code>ï¼šå£°æ˜äº¤æ¢æœº</p>
<blockquote>
<p><code>name = &quot;exchangename&quot;</code>ï¼šæŒ‡å®šäº¤æ¢æœºå<br><code>type = &quot;topic&quot;</code>ã€<code>type = ExchangeTypes.TOPIC</code>ï¼šæŒ‡å®šäº¤æ¢æœºç±»å‹ï¼Œå¯ä»¥æŒ‡å®šå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šå¸¸é‡</p>
</blockquote>
<p><code>key = &#123;&quot;key.#&quot;, &quot;#.key&quot;&#125;</code>ï¼šæŒ‡å®šBindingKeyï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.ExchangeTypes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.Exchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.QueueBinding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringRabbitMQListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">            value = @Queue(name = &quot;queuename1&quot;),</span></span><br><span class="line"><span class="meta">            exchange = @Exchange(name = &quot;exchangename&quot;, type = &quot;topic&quot;),</span></span><br><span class="line"><span class="meta">            key = &#123;&quot;key.#&quot;&#125;</span></span><br><span class="line"><span class="meta">    ))</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive1</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename1: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(bindings = @QueueBinding(</span></span><br><span class="line"><span class="meta">            value = @Queue(name = &quot;queuename2&quot;),</span></span><br><span class="line"><span class="meta">            exchange = @Exchange(name = &quot;exchangename&quot;, type = ExchangeTypes.TOPIC),</span></span><br><span class="line"><span class="meta">            key = &#123;&quot;#.key&quot;&#125;</span></span><br><span class="line"><span class="meta">    ))</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive2</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename2: &quot;</span> + message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å°†æ¶ˆæ¯è½¬æ¢æ–¹å¼æ”¹ä¸ºJSON"><a href="#å°†æ¶ˆæ¯è½¬æ¢æ–¹å¼æ”¹ä¸ºJSON" class="headerlink" title="å°†æ¶ˆæ¯è½¬æ¢æ–¹å¼æ”¹ä¸ºJSON"></a>å°†æ¶ˆæ¯è½¬æ¢æ–¹å¼æ”¹ä¸ºJSON</h2><ul>
<li>é»˜è®¤çš„æ¶ˆæ¯è½¬æ¢æ–¹å¼æ˜¯JDKçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æ–¹å¼ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¸¦æ¥çš„é—®é¢˜æ˜¯æ¶ˆæ¯å†…å®¹è¿‡é•¿ï¼ŒåŒæ—¶JDKåºåˆ—åŒ–å¯èƒ½ä¼šè¢«æ¼æ´åˆ©ç”¨</li>
<li>å¯ä»¥å°†æ¶ˆæ¯è½¬æ¢æ–¹å¼æ”¹ä¸ºJSONçš„æ–¹å¼</li>
</ul>
<h3 id="å¼•å…¥ä¾èµ–-1"><a href="#å¼•å…¥ä¾èµ–-1" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºé…ç½®ç±»"><a href="#åˆ›å»ºé…ç½®ç±»" class="headerlink" title="åˆ›å»ºé…ç½®ç±»"></a>åˆ›å»ºé…ç½®ç±»</h3><figure class="highlight java"><figcaption><span>src/main/java/com/ApplicationConfig.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.support.converter.Jackson2JsonMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.support.converter.MessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringBootConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MessageConverter <span class="title function_">messageConverter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Jackson2JsonMessageConverter</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å‘é€å’Œæ¥æ”¶æ¶ˆæ¯"><a href="#å‘é€å’Œæ¥æ”¶æ¶ˆæ¯" class="headerlink" title="å‘é€å’Œæ¥æ”¶æ¶ˆæ¯"></a>å‘é€å’Œæ¥æ”¶æ¶ˆæ¯</h3><h4 id="å‘é€æ¶ˆæ¯"><a href="#å‘é€æ¶ˆæ¯" class="headerlink" title="å‘é€æ¶ˆæ¯"></a>å‘é€æ¶ˆæ¯</h4><figure class="highlight java"><figcaption><span>src/test/java/com/ApplicationTests.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.core.RabbitTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">send</span><span class="params">()</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>);</span><br><span class="line">        rabbitTemplate.convertAndSend(<span class="string">&quot;queuename&quot;</span>, map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="æ¥æ”¶æ¶ˆæ¯-1"><a href="#æ¥æ”¶æ¶ˆæ¯-1" class="headerlink" title="æ¥æ”¶æ¶ˆæ¯"></a>æ¥æ”¶æ¶ˆæ¯</h4><figure class="highlight java"><figcaption><span>src/main/java/com/listener/SpringRabbitMQListener.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.listener;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.core.ExchangeTypes;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.Exchange;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.Queue;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.QueueBinding;</span><br><span class="line"><span class="keyword">import</span> org.springframework.amqp.rabbit.annotation.RabbitListener;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringRabbitMQListener</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener(queues = &quot;queuename&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">receive</span><span class="params">(Map&lt;String, Object&gt; map)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;queuename: &quot;</span> + map);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®Œæˆ"><a href="#å®Œæˆ" class="headerlink" title="å®Œæˆ"></a>å®Œæˆ</h2><h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a href="/302.html?target=https://www.bilibili.com/video/BV1LQ4y127n4/">å“”å“©å“”å“©â€”â€”é»‘é©¬ç¨‹åºå‘˜</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Javaåç«¯å­¦ä¹ æŒ‡åŒ—/">Javaåç«¯å­¦ä¹ æŒ‡åŒ—</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Java/">Java</a><a href="/tags/Spring/">Spring</a><a href="/tags/SpringBoot/">SpringBoot</a><a href="/tags/MessageQueue/">MessageQueue</a>
    </span>
    

    </div>

    
  </div>
</article>

  









    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2024 ç»¯é 
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>