<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ã€ç¬”è®°ã€‘Eurekaå­¦ä¹ ç¬”è®° | ç»¯é çš„åšå®¢ | è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</title>

  
  <meta name="author" content="ç»¯é ">
  

  
  <meta name="description" content="æ•æ‰ä¸€åªçˆ±æŠ˜è…¾çš„ç»¯é ">
  

  
  
  <meta name="keywords" content="Java,Spring,SpringBoot,SpringCloud">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="ã€ç¬”è®°ã€‘Eurekaå­¦ä¹ ç¬”è®°"/>

  <meta property="og:site_name" content="ç»¯é çš„åšå®¢"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ç»¯é çš„åšå®¢" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">ç»¯é çš„åšå®¢</a>
    </h1>
    <p class="site-description">è¿èœœç»Ÿæ²»ä¸–ç•Œ!!!ğŸ’•</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">ä¸»é¡µ</a></li>
      
        <li><a href="/about/">å…³äº</a></li>
      
        <li><a href="/tags/">æ ‡ç­¾</a></li>
      
        <li><a href="/categories/">åˆ†ç±»</a></li>
      
        <li><a href="/archives/">å½’æ¡£</a></li>
      
        <li><a href="/links/">å‹é“¾</a></li>
      
        <li><a href="/reward/">èµåŠ©</a></li>
      
        <li><a href="/atom.xml">è®¢é˜…</a></li>
      
        <li><a target="_blank" rel="noopener" href="//stellar.loli.fj.cn">ä¸»é¢˜</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>ã€ç¬”è®°ã€‘Eurekaå­¦ä¹ ç¬”è®°</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2020/11/23/Eurekaå­¦ä¹ ç¬”è®°/" rel="bookmark">
        <time class="entry-date published" datetime="2020-11-23T09:33:58.000Z">
          2020-11-23
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Eureka is a REST (Representational State Transfer) based service that is primarily used in the AWS cloud for locating services for the purpose of load balancing and failover of middle-tier servers.ï¼ˆ<a href="/302.html?target=https://github.com/Netflix/eureka">Github</a>ï¼‰</p>
<span id="more"></span>

<h2 id="Eurekaä¸­å¾®æœåŠ¡çš„è§’è‰²åˆ†ç±»"><a href="#Eurekaä¸­å¾®æœåŠ¡çš„è§’è‰²åˆ†ç±»" class="headerlink" title="Eurekaä¸­å¾®æœåŠ¡çš„è§’è‰²åˆ†ç±»"></a>Eurekaä¸­å¾®æœåŠ¡çš„è§’è‰²åˆ†ç±»</h2><ul>
<li>EurekaServeræœåŠ¡ç«¯<ul>
<li>æ³¨å†Œä¸­å¿ƒ<ul>
<li>è®°å½•æœåŠ¡ä¿¡æ¯</li>
<li>å¿ƒè·³ç›‘æ§</li>
</ul>
</li>
</ul>
</li>
<li>EurekaClientå®¢æˆ·ç«¯<ul>
<li>Providerç”Ÿäº§è€…<ul>
<li>æ³¨å†Œè‡ªå·±çš„ä¿¡æ¯åˆ°EurekaServeræœåŠ¡ç«¯</li>
<li>æ¯éš”30ç§’å‘EurekaServerå‘é€å¿ƒè·³</li>
</ul>
</li>
<li>Consumeræ¶ˆè´¹è€…<ul>
<li>æ ¹æ®æœåŠ¡åç§°ä»EurekaServeræ‹‰å»æœåŠ¡åˆ—è¡¨</li>
<li>åŸºäºæœåŠ¡åˆ—è¡¨åšè´Ÿè½½å‡è¡¡ï¼Œé€‰ä¸­ä¸€ä¸ªå¾®æœåŠ¡åå‘èµ·è¿œç¨‹è°ƒç”¨</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="çˆ¶çº§ä¾èµ–"><a href="#çˆ¶çº§ä¾èµ–" class="headerlink" title="çˆ¶çº§ä¾èµ–"></a>çˆ¶çº§ä¾èµ–</h2><ul>
<li>é€šè¿‡çˆ¶çº§ä¾èµ–ç»Ÿä¸€æ§åˆ¶å­çº§ä¾èµ–çš„ç‰ˆæœ¬</li>
</ul>
<figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencyManagement</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-dependencies<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>Hoxton.SR10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>import<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å•å°æ³¨å†Œä¸­å¿ƒ"><a href="#å•å°æ³¨å†Œä¸­å¿ƒ" class="headerlink" title="å•å°æ³¨å†Œä¸­å¿ƒ"></a>å•å°æ³¨å†Œä¸­å¿ƒ</h2><ul>
<li>å•å°æœåŠ¡ç«¯ï¼Œå¤šå°å®¢æˆ·ç«¯</li>
</ul>
<h3 id="EurekaServeræœåŠ¡ç«¯"><a href="#EurekaServeræœåŠ¡ç«¯" class="headerlink" title="EurekaServeræœåŠ¡ç«¯"></a>EurekaServeræœåŠ¡ç«¯</h3><h4 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="å¯åŠ¨ç±»æ³¨å†Œ"><a href="#å¯åŠ¨ç±»æ³¨å†Œ" class="headerlink" title="å¯åŠ¨ç±»æ³¨å†Œ"></a>å¯åŠ¨ç±»æ³¨å†Œ</h4><ul>
<li>åœ¨å¯åŠ¨ç±»æ·»åŠ <code>@EnableEurekaServer</code>æ³¨è§£å¯åŠ¨Eureka</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		SpringApplication.run(Application.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹é…ç½®"><a href="#ä¿®æ”¹é…ç½®" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h4><blockquote>
<p><code>server.port</code>ï¼šç«¯å£å·ï¼Œé»˜è®¤ä¸º8761<br><code>spring.application.name</code>ï¼šæœåŠ¡åç§°ã€‚æœåŠ¡åç§°ä¸æ˜¯åŸŸåï¼Œä¸èƒ½è¢«ç›´æ¥è®¿é—®<br><code>eureka.client.service-url.defaultZone</code>ï¼šï¼šæ³¨å†ŒæœåŠ¡åˆ°æ³¨å†Œä¸­å¿ƒï¼Œå•å°ä¸­æŒ‡å‘è‡ªå·±<br><code>eureka.server.instance.hostname</code>ï¼šä¸»æœºåï¼Œé›†ç¾¤ä¸­åŒºåˆ†ä¸åŒæœåŠ¡å™¨çš„åŸŸå<br><code>eureka.server.enable-self-preservation</code>ï¼šæ˜¯å¦å¼€å¯ä¿æŠ¤æ¨¡å¼ï¼Œé»˜è®¤ä¸ºtrueï¼Œå¼€å‘æœŸé—´ç¦ç”¨ä¿æŠ¤æ¨¡å¼<br><code>eureka.client.register-with-eureka=false</code>ï¼šå•å°æœåŠ¡å™¨ä¸å‘è‡ªèº«æ³¨å†Œ<br><code>eureka.client.fetch-registry=false</code>ï¼šå•å°æœåŠ¡å™¨ä¸ä»è‡ªèº«æ‹‰å–æ³¨å†Œä¿¡æ¯<br><code>eureka.instance.lease-expiration-duration-in-seconds</code>ï¼šæœ€åä¸€æ¬¡å¿ƒè·³åï¼Œé—´éš”å¤šä¹…è®¤å®šå¾®æœåŠ¡ä¸å¯ç”¨ï¼Œé»˜è®¤90</p>
</blockquote>
<figure class="highlight yaml"><figcaption><span>src/main/resources/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">eureka-server</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span> </span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:8000/eureka</span></span><br></pre></td></tr></table></figure>

<ul>
<li>eureka çš„è‡ªæˆ‘ä¿æŠ¤çŠ¶æ€ï¼šå¿ƒè·³å¤±è´¥çš„æ¯”ä¾‹ï¼Œåœ¨15åˆ†é’Ÿå†…æ˜¯å¦è¶…è¿‡85%,å¦‚æœå‡ºç°äº†è¶…è¿‡çš„æƒ…å†µï¼ŒEureka Serverä¼šå°†å½“å‰çš„å®ä¾‹æ³¨å†Œä¿¡æ¯ä¿æŠ¤èµ·æ¥ï¼ŒåŒæ—¶æç¤ºä¸€ä¸ªè­¦å‘Šï¼Œä¸€æ—¦è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼ŒEureka Serverå°†ä¼šå°è¯•ä¿æŠ¤å…¶æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡</li>
</ul>
<h4 id="å¯åŠ¨æœåŠ¡ç«¯"><a href="#å¯åŠ¨æœåŠ¡ç«¯" class="headerlink" title="å¯åŠ¨æœåŠ¡ç«¯"></a>å¯åŠ¨æœåŠ¡ç«¯</h4><blockquote>
<p><code>&lt;server&gt;</code>ï¼šæœåŠ¡ç«¯jaråŒ…</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar &lt;server&gt;.jar --server.port=8001 --eureka.client.service-url.defaultZone=8001</span><br></pre></td></tr></table></figure>

<h3 id="EurekaClientå®¢æˆ·ç«¯"><a href="#EurekaClientå®¢æˆ·ç«¯" class="headerlink" title="EurekaClientå®¢æˆ·ç«¯"></a>EurekaClientå®¢æˆ·ç«¯</h3><h4 id="å¼•å…¥ä¾èµ–-1"><a href="#å¼•å…¥ä¾èµ–-1" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹é…ç½®-1"><a href="#ä¿®æ”¹é…ç½®-1" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h4><figure class="highlight yaml"><figcaption><span>src/main/resources/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">eureka-serveice</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:8000/eureka</span></span><br></pre></td></tr></table></figure>

<h4 id="å¯åŠ¨å®¢æˆ·ç«¯"><a href="#å¯åŠ¨å®¢æˆ·ç«¯" class="headerlink" title="å¯åŠ¨å®¢æˆ·ç«¯"></a>å¯åŠ¨å®¢æˆ·ç«¯</h4><ul>
<li>å¯åŠ¨2ä¸ªå®¢æˆ·ç«¯ï¼ŒæŒ‡å‘æ³¨å†Œä¸­å¿ƒ</li>
</ul>
<blockquote>
<p><code>&lt;client&gt;</code>ï¼šå®¢æˆ·ç«¯jaråŒ…</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar &lt;client&gt;.jar --spring.application.name=user-serveice --server.port=8081 --eureka.client.service-url.defaultZone=http://127.0.0.1:8001/eureka</span><br><span class="line">java -jar &lt;client&gt;.jar --spring.application.name=order-serveice --server.port=8082 --eureka.client.service-url.defaultZone=http://127.0.0.1:8001/eureka</span><br></pre></td></tr></table></figure>

<h2 id="å¤šå°æ³¨å†Œä¸­å¿ƒé›†ç¾¤"><a href="#å¤šå°æ³¨å†Œä¸­å¿ƒé›†ç¾¤" class="headerlink" title="å¤šå°æ³¨å†Œä¸­å¿ƒé›†ç¾¤"></a>å¤šå°æ³¨å†Œä¸­å¿ƒé›†ç¾¤</h2><ul>
<li>å¤šå°æœåŠ¡ç«¯ï¼Œå¤šå°å®¢æˆ·ç«¯</li>
</ul>
<h3 id="EurekaServeræœåŠ¡ç«¯-1"><a href="#EurekaServeræœåŠ¡ç«¯-1" class="headerlink" title="EurekaServeræœåŠ¡ç«¯"></a>EurekaServeræœåŠ¡ç«¯</h3><h4 id="å¼•å…¥ä¾èµ–-2"><a href="#å¼•å…¥ä¾èµ–-2" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="å¯åŠ¨ç±»æ³¨å†Œ-1"><a href="#å¯åŠ¨ç±»æ³¨å†Œ-1" class="headerlink" title="å¯åŠ¨ç±»æ³¨å†Œ"></a>å¯åŠ¨ç±»æ³¨å†Œ</h4><ul>
<li>åœ¨å¯åŠ¨ç±»æ·»åŠ <code>@EnableEurekaServer</code>æ³¨è§£å¯åŠ¨Eureka</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		SpringApplication.run(Application.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹é…ç½®-2"><a href="#ä¿®æ”¹é…ç½®-2" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h4><blockquote>
<p><code>eureka.client.service-url.defaultZone</code>ï¼šï¼šæ³¨å†ŒæœåŠ¡åˆ°æ³¨å†Œä¸­å¿ƒï¼Œé›†ç¾¤ä¸­æŒ‡å‘å…¶ä»–æ³¨å†Œä¸­å¿ƒ</p>
</blockquote>
<figure class="highlight yaml"><figcaption><span>src/main/resources/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">eureka-server</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span> </span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:8000/eureka</span></span><br></pre></td></tr></table></figure>

<h4 id="å¯åŠ¨æœåŠ¡ç«¯-1"><a href="#å¯åŠ¨æœåŠ¡ç«¯-1" class="headerlink" title="å¯åŠ¨æœåŠ¡ç«¯"></a>å¯åŠ¨æœåŠ¡ç«¯</h4><blockquote>
<p><code>&lt;server&gt;</code>ï¼šæœåŠ¡ç«¯jaråŒ…</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar &lt;server&gt;.jar --server.port=8001 --eureka.instance.hostname=eureka1 --eureka.client.service-url.defaultZone=http://127.0.0.1:8002/eureka</span><br><span class="line">java -jar &lt;server&gt;.jar --server.port=8002 --eureka.instance.hostname=eureka2 --eureka.client.service-url.defaultZone=http://127.0.0.1:8001/eureka</span><br></pre></td></tr></table></figure>

<h3 id="EurekaClientå®¢æˆ·ç«¯-1"><a href="#EurekaClientå®¢æˆ·ç«¯-1" class="headerlink" title="EurekaClientå®¢æˆ·ç«¯"></a>EurekaClientå®¢æˆ·ç«¯</h3><h4 id="å¼•å…¥ä¾èµ–-3"><a href="#å¼•å…¥ä¾èµ–-3" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h4><figure class="highlight xml"><figcaption><span>pom.xml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹é…ç½®-3"><a href="#ä¿®æ”¹é…ç½®-3" class="headerlink" title="ä¿®æ”¹é…ç½®"></a>ä¿®æ”¹é…ç½®</h4><ul>
<li>æ¯ä¸ªå®¢æˆ·ç«¯åŒæ—¶æ³¨å†Œä¸¤ä¸ªæœåŠ¡ç«¯</li>
</ul>
<figure class="highlight yaml"><figcaption><span>src/main/resources/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">eureka-service-user</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://127.0.0.1:8000/eureka,http://127.0.0.1:8000/eureka</span></span><br></pre></td></tr></table></figure>

<h4 id="å¯åŠ¨å®¢æˆ·ç«¯-1"><a href="#å¯åŠ¨å®¢æˆ·ç«¯-1" class="headerlink" title="å¯åŠ¨å®¢æˆ·ç«¯"></a>å¯åŠ¨å®¢æˆ·ç«¯</h4><ul>
<li>å¯åŠ¨æ—¶æ·»åŠ å¯åŠ¨å‚æ•°ä½œä¸ºå¤šä¸ªå®¢æˆ·ç«¯å¯åŠ¨å¤šå°</li>
</ul>
<blockquote>
<p><code>&lt;client&gt;</code>ï¼šå®¢æˆ·ç«¯jaråŒ…</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar &lt;client&gt;.jar --server.port=8081 --eureka.client.service-url.defaultZone=http://127.0.0.1:8001/eureka,http://127.0.0.1:8002/eureka</span><br><span class="line">java -jar &lt;client&gt;.jar --server.port=8082 --eureka.client.service-url.defaultZone=http://127.0.0.1:8001/eureka,http://127.0.0.1:8002/eureka</span><br></pre></td></tr></table></figure>

<h2 id="æ¶ˆè´¹è€…è®¿é—®ç”Ÿäº§è€…"><a href="#æ¶ˆè´¹è€…è®¿é—®ç”Ÿäº§è€…" class="headerlink" title="æ¶ˆè´¹è€…è®¿é—®ç”Ÿäº§è€…"></a>æ¶ˆè´¹è€…è®¿é—®ç”Ÿäº§è€…</h2><h3 id="æ·»åŠ RestTemplateçš„Bean"><a href="#æ·»åŠ RestTemplateçš„Bean" class="headerlink" title="æ·»åŠ RestTemplateçš„Bean"></a>æ·»åŠ RestTemplateçš„Bean</h3><ul>
<li>åœ¨Beanä¸Šæ·»åŠ <code>@LoadBalanced</code>æ³¨è§£å®ç°å‘ç”Ÿäº§è€…å‘é€è¯·æ±‚æ—¶çš„è´Ÿè½½å‡è¡¡</li>
<li>è¢«<code>@LoadBalanced</code>æ³¨è§£æ ‡æ³¨çš„RestTemplateï¼Œå‘å‡ºçš„è¯·æ±‚ä¼šè¢«Ribbonæ‹¦æˆªï¼ŒRibbonä¼šå…ˆå‘Eurekaæ ¹æ®æœåŠ¡åæ‹‰å–è¯·æ±‚çš„çœŸå®åœ°å€ï¼Œå†è¿›è¡Œè´Ÿè½½å‡è¡¡</li>
</ul>
<figure class="highlight java"><figcaption><span>src/main/java/com/conf/RestTemplateConfig.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringBootConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ¶ˆè´¹è€…é€šè¿‡æœåŠ¡åè®¿é—®ç”Ÿäº§è€…"><a href="#æ¶ˆè´¹è€…é€šè¿‡æœåŠ¡åè®¿é—®ç”Ÿäº§è€…" class="headerlink" title="æ¶ˆè´¹è€…é€šè¿‡æœåŠ¡åè®¿é—®ç”Ÿäº§è€…"></a>æ¶ˆè´¹è€…é€šè¿‡æœåŠ¡åè®¿é—®ç”Ÿäº§è€…</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">RestTemplate restTemplate</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;http://eureka-service-user/users/&quot;</span> + order.getUserId();</span><br><span class="line">    <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> restTemplate.getForObject(url, User.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¿®æ”¹è´Ÿè½½å‡è¡¡çš„æ–¹å¼"><a href="#ä¿®æ”¹è´Ÿè½½å‡è¡¡çš„æ–¹å¼" class="headerlink" title="ä¿®æ”¹è´Ÿè½½å‡è¡¡çš„æ–¹å¼"></a>ä¿®æ”¹è´Ÿè½½å‡è¡¡çš„æ–¹å¼</h2><h3 id="é€šè¿‡é…ç½®ç±»ä¿®æ”¹"><a href="#é€šè¿‡é…ç½®ç±»ä¿®æ”¹" class="headerlink" title="é€šè¿‡é…ç½®ç±»ä¿®æ”¹"></a>é€šè¿‡é…ç½®ç±»ä¿®æ”¹</h3><ul>
<li>ä¸ºæ‰€æœ‰æœåŠ¡ä¿®æ”¹è´Ÿè½½å‡è¡¡æ–¹å¼</li>
</ul>
<h4 id="è½®è¯¢æ–¹å¼"><a href="#è½®è¯¢æ–¹å¼" class="headerlink" title="è½®è¯¢æ–¹å¼"></a>è½®è¯¢æ–¹å¼</h4><figure class="highlight java"><figcaption><span>src/main/java/com/conf/RestTemplateConfig.java</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringBootConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> IRule <span class="title function_">iRule</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ZoneAvoidanceRule</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="éšæœºæ–¹å¼"><a href="#éšæœºæ–¹å¼" class="headerlink" title="éšæœºæ–¹å¼"></a>éšæœºæ–¹å¼</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.conf;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.netflix.loadbalancer.IRule;</span><br><span class="line"><span class="keyword">import</span> com.netflix.loadbalancer.RandomRule;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringBootConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.loadbalancer.LoadBalanced;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootConfiguration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RestTemplateConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> RestTemplate <span class="title function_">restTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RestTemplate</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> IRule <span class="title function_">iRule</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RandomRule</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹"><a href="#é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹" class="headerlink" title="é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹"></a>é€šè¿‡é…ç½®æ–‡ä»¶ä¿®æ”¹</h3><ul>
<li>ä¸ºæŒ‡å®šæœåŠ¡ä¿®æ”¹è´Ÿè½½å‡è¡¡æ–¹å¼</li>
</ul>
<h4 id="è½®è¯¢æ–¹å¼-1"><a href="#è½®è¯¢æ–¹å¼-1" class="headerlink" title="è½®è¯¢æ–¹å¼"></a>è½®è¯¢æ–¹å¼</h4><figure class="highlight yaml"><figcaption><span>src/main/resources/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">æœåŠ¡å:</span></span><br><span class="line">  <span class="attr">ribbon:</span></span><br><span class="line">    <span class="attr">NFLoadBalancerRuleClassName:</span> <span class="string">com.netflix.loadbalancer.ZoneAvoidanceRule</span></span><br></pre></td></tr></table></figure>

<h4 id="éšæœºæ–¹å¼-1"><a href="#éšæœºæ–¹å¼-1" class="headerlink" title="éšæœºæ–¹å¼"></a>éšæœºæ–¹å¼</h4><figure class="highlight yaml"><figcaption><span>src/main/resources/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">æœåŠ¡å:</span></span><br><span class="line">  <span class="attr">ribbon:</span></span><br><span class="line">    <span class="attr">NFLoadBalancerRuleClassName:</span> <span class="string">com.netflix.loadbalancer.RandomRule</span></span><br></pre></td></tr></table></figure>

<h2 id="é¥¥é¥¿åŠ è½½é…ç½®"><a href="#é¥¥é¥¿åŠ è½½é…ç½®" class="headerlink" title="é¥¥é¥¿åŠ è½½é…ç½®"></a>é¥¥é¥¿åŠ è½½é…ç½®</h2><ul>
<li>Ribboné»˜è®¤ä½¿ç”¨æ‡’åŠ è½½æ–¹å¼ï¼Œåªæœ‰ç¬¬ä¸€æ¬¡è®¿é—®æœåŠ¡æ—¶ï¼Œæ‰ä¼šå»Eurekaæ³¨å†Œä¸­å¿ƒæ‹‰å–æœåŠ¡åœ°å€</li>
<li>ä¸æ‡’åŠ è½½ç›¸å¯¹åº”çš„æ˜¯é¥¥é¥¿åŠ è½½ï¼Œå½“å¼€å¯äº†é¥¥é¥¿åŠ è½½ï¼Œå½“å¯åŠ¨æœåŠ¡å™¨æ—¶å°±ä¼šåœ¨Eurekaæ³¨å†Œä¸­å¿ƒæ‹‰å–æœåŠ¡åœ°å€</li>
</ul>
<blockquote>
<p><code>ribbon.eager-load.enable</code>ï¼šæŒ‡å®šæ˜¯å¦å¼€å¯é¥¥é¥¿åŠ è½½<br><code>ribbon.eager-load.clients</code>ï¼šæŒ‡å®šéœ€è¦é¥¥é¥¿åŠ è½½çš„æœåŠ¡åã€‚å¦‚æœæ˜¯å¤šä¸ªæœåŠ¡ï¼Œéœ€è¦æŒ‡å®šYamlé›†åˆã€‚å¦‚æœä¸æŒ‡å®šï¼Œåˆ™æ‰€æœ‰æœåŠ¡éƒ½è¢«é¥¥é¥¿åŠ è½½</p>
</blockquote>
<figure class="highlight yaml"><figcaption><span>src/main/resources/application.yml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ribbon:</span></span><br><span class="line">  <span class="attr">eager-load:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="å®Œæˆ"><a href="#å®Œæˆ" class="headerlink" title="å®Œæˆ"></a>å®Œæˆ</h2><ul>
<li>å•å°</li>
</ul>
<p><img src="/images/20201123173358/01.webp"></p>
<ul>
<li>é›†ç¾¤</li>
</ul>
<p><img src="/images/20201123173358/02.gif"></p>
<h2 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1LQ4y127n4/">å“”å“©å“”å“©â€”â€”é»‘é©¬ç¨‹åºå‘˜</a></p>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/Javaåç«¯å­¦ä¹ æŒ‡åŒ—/">Javaåç«¯å­¦ä¹ æŒ‡åŒ—</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/Java/">Java</a><a href="/tags/Spring/">Spring</a><a href="/tags/SpringBoot/">SpringBoot</a><a href="/tags/SpringCloud/">SpringCloud</a>
    </span>
    

    </div>

    
  </div>
</article>

  









    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2024 ç»¯é 
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>